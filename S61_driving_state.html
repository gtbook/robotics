

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>6.1. Planar Geometry &#8212; Introduction to Robotics and Perception</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-312077-7"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-312077-7');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'S61_driving_state';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6.2. Kinematics for Driving" href="S62_driving_actions.html" />
    <link rel="prev" title="6. Autonomous Vehicles" href="S60_driving_intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Introduction to Robotics and Perception - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Introduction to Robotics and Perception - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction to Robotics and Perception
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="S10_introduction.html">1. Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="S11_intro_state.html">1.1. Representing State</a></li>
<li class="toctree-l2"><a class="reference internal" href="S12_intro_actions.html">1.2. Robot Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="S13_intro_sensing.html">1.3. Sensing</a></li>
<li class="toctree-l2"><a class="reference internal" href="S14_intro_perception.html">1.4. Perception</a></li>
<li class="toctree-l2"><a class="reference internal" href="S15_intro_decision.html">1.5. Planning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S16_intro_learning.html">1.6. Learning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S20_sorter_intro.html">2. A Trash Sorting Robot</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="S21_sorter_state.html">2.1. Modeling the World State</a></li>
<li class="toctree-l2"><a class="reference internal" href="S22_sorter_actions.html">2.2. Actions for Sorting Trash</a></li>
<li class="toctree-l2"><a class="reference internal" href="S23_sorter_sensing.html">2.3. Sensors for Sorting Trash</a></li>
<li class="toctree-l2"><a class="reference internal" href="S24_sorter_perception.html">2.4. Perception</a></li>
<li class="toctree-l2"><a class="reference internal" href="S25_sorter_decision_theory.html">2.5. Decision Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="S26_sorter_learning.html">2.6. Learning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S30_vacuum_intro.html">3. A Robot Vacuum Cleaner</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="S31_vacuum_state.html">3.1. Modeling the State of the Vacuum Cleaning Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="S32_vacuum_actions.html">3.2. Actions over time</a></li>
<li class="toctree-l2"><a class="reference internal" href="S33_vacuum_sensing.html">3.3. Dynamic Bayes Nets</a></li>
<li class="toctree-l2"><a class="reference internal" href="S34_vacuum_perception.html">3.4. Perception with Graphical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="S35_vacuum_decision.html">3.5. Markov Decision Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="S36_vacuum_RL.html">3.6. Reinforcement Learning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S40_logistics_intro.html">4. Warehouse Robots in 2D</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="S41_logistics_state.html">4.1. Continuous State</a></li>
<li class="toctree-l2"><a class="reference internal" href="S42_logistics_actions.html">4.2. Moving in 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="S43_logistics_sensing.html">4.3. Sensor Models with Continuous State</a></li>
<li class="toctree-l2"><a class="reference internal" href="S44_logistics_perception.html">4.4. Localization</a></li>
<li class="toctree-l2"><a class="reference internal" href="S45_logistics_planning.html">4.5. Planning for Logistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="S46_logistics_learning.html">4.6. Some System Identification</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S50_diffdrive_intro.html">5. A Mobile Robot With Simple Kinematics</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="S51_diffdrive_state.html">5.1. State Space for a Differential Drive Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="S52_diffdrive_actions.html">5.2. Motion Model for the Differential Drive Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="S53_diffdrive_sensing.html">5.3. Robot Vision</a></li>
<li class="toctree-l2"><a class="reference internal" href="S54_diffdrive_perception.html">5.4. Computer Vision 101</a></li>
<li class="toctree-l2"><a class="reference internal" href="S55_diffdrive_planning.html">5.5. Path Planning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S56_diffdrive_learning.html">5.6. Deep Learning</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="S60_driving_intro.html">6. Autonomous Vehicles</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.1. Planar Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="S62_driving_actions.html">6.2. Kinematics for Driving</a></li>
<li class="toctree-l2"><a class="reference internal" href="S63_driving_sensing.html">6.3. Sensing for Autonomous Vehicles</a></li>
<li class="toctree-l2"><a class="reference internal" href="S64_driving_perception.html">6.4. SLAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="S65_driving_planning.html">6.5. Planning for Autonomous Driving.</a></li>
<li class="toctree-l2"><a class="reference internal" href="S66_driving_DRL.html">6.6. Deep Reinforcement Learning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S70_drone_intro.html">7. Autonomous Drones in 3D</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="S71_drone_state.html">7.1. Moving in Three Dimensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="S72_drone_actions.html">7.2. Multi-rotor Aircraft</a></li>
<li class="toctree-l2"><a class="reference internal" href="S73_drone_sensing.html">7.3. Sensing for Drones</a></li>
<li class="toctree-l2"><a class="reference internal" href="S74_drone_perception.html">7.4. Visual SLAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="S75_drone_planning.html">7.5. Trajectory Optimization</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/gtbook/robotics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/gtbook/robotics/issues/new?title=Issue%20on%20page%20%2FS61_driving_state.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/S61_driving_state.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Planar Geometry</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#planar-rotations">6.1.1. Planar Rotations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-special-orthogonal-group-of-order-2-aka-so-2">6.1.2. The Special Orthogonal Group of Order 2, aka SO(2)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-transformations-for-pure-rotations">6.1.3. Coordinate Transformations for Pure Rotations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-group-so-2-in-gtsam">6.1.4. The Group <span class="math notranslate nohighlight">\(SO(2)\)</span> in GTSAM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-rigid-transforms-aka-se-2">6.1.5. 2D Rigid Transforms aka SE(2)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#composition-of-homogeneous-transformations">6.1.6. Composition of Homogeneous Transformations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-group-se-2-in-gtsam">6.1.7. The Group <span class="math notranslate nohighlight">\(SE(2)\)</span> in GTSAM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lie-groups">6.1.8. Lie Groups*</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a href="https://colab.research.google.com/github/gtbook/robotics/blob/main/S61_driving_state.ipynb" target="_parent"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="planar-geometry">
<h1><span class="section-number">6.1. </span>Planar Geometry<a class="headerlink" href="#planar-geometry" title="Permalink to this heading">#</a></h1>
<blockquote>
<div><p>Linear algebra can be used to deal efficiently with rotation and translations in the plane.</p>
</div></blockquote>
<a class="reference internal image-reference" href="_images/S61-Autonomous_Vehicle_with_LIDAR_and_cameras-07.jpg"><img alt="Splash image with steampunk autonomous car" class="align-center" src="_images/S61-Autonomous_Vehicle_with_LIDAR_and_cameras-07.jpg" style="width: 40%;" /></a>
<p>In the previous chapter, we saw that the configuration space for a differential drive robot
can be represented as  <span class="math notranslate nohighlight">\({\cal Q} = \mathbb{R}^2 \times [0, 2\pi),\)</span>
and we used <span class="math notranslate nohighlight">\(q = (x,y,\theta)\)</span> to parameterize this configuration space.
This choice of parameterization has the nice property of being minimal:
<span class="math notranslate nohighlight">\({\cal Q}\)</span> is a three-dimensional object, and therefore at least three
parameters are required to represent arbitrary configurations.
Unfortunately, this choice of parameterization doesn’t help much when reasoning
about the geometry of the robot and its motion.
Recall, for example, the ad hoc planar geometry we used to derive coordinates of points
on the DDR as a function of <span class="math notranslate nohighlight">\(x,y,\theta\)</span>.
In this section, we use tools from linear algebra to represent and manipulate configurations.
We begin by focusing our attention on representing orientation.
We then extend our methods to include translation, and develop methods
to describe relative configurations of a robot, which could be used to describe
sample points along a continuous trajectory in <span class="math notranslate nohighlight">\(\cal Q\)</span>.</p>
<section id="planar-rotations">
<h2><span class="section-number">6.1.1. </span>Planar Rotations<a class="headerlink" href="#planar-rotations" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p>Rotation in the plane can be represented using <span class="math notranslate nohighlight">\(2\times 2\)</span> rotation matrices.</p>
</div></blockquote>
<p>In the previous chapter, we represented the orientation of the robot simply by <span class="math notranslate nohighlight">\(\theta \in [0,2\pi)\)</span>.
There are two main drawbacks to this choice.
First, the mapping from the robot’s orientation to the parameter <span class="math notranslate nohighlight">\(\theta\)</span> is not continuous.
If the robot’s orientation is <span class="math notranslate nohighlight">\(\theta = 2\pi - \epsilon\)</span>, for example, and we rotate the robot counterclockwise
(decreasing <span class="math notranslate nohighlight">\(\epsilon\)</span> to zero), we will encounter a discontinuity when <span class="math notranslate nohighlight">\(\theta\)</span> goes from very nearly <span class="math notranslate nohighlight">\(2\pi\)</span> to zero.  This will occur regardless of the initial
value we choose for <span class="math notranslate nohighlight">\(\epsilon\)</span>: when <span class="math notranslate nohighlight">\(\epsilon\)</span> reaches zero, there will be a jump in the value of <span class="math notranslate nohighlight">\(\theta\)</span>.
We call this jump a <span class="math notranslate nohighlight">\(singularity\)</span>.
The second drawback is that parameterizing orientation by a single angle <span class="math notranslate nohighlight">\(\theta\)</span> does not generalize in a straightforward way to representing orientation in 3D.
Further, even if we go to the effort to make this generalization work, the problems with singularities
are complex for 3-dimensional rotations, and can cause serious problems if not handled properly.</p>
<figure id="fig:2drotation">
<img src="https://github.com/gtbook/robotics/blob/main/Figures6/2D-rotation.PNG?raw=1" style="width:10cm" alt="">
<figcaption>Two coordinate frames that share a common origin.</figcaption>
</figure><p>Both difficulties above stem from the use of a minimal representation of orientation.
To solve these problems, we’ll introduce a somewhat redundant representation that explicity
encodes the orientation of the axes of a target coordinate frame relative to a reference coordinate frame.
Consider the two coordinate frames shown in the figure above.
These two frames share a common origin, and Frame 1 is obtained by rotating by an angle <span class="math notranslate nohighlight">\(\theta\)</span> w.r.t.
frame 0.
We can express the <span class="math notranslate nohighlight">\(x\)</span>-axis of Frame 1 in coordinates relative to Frame 0
by projecting <span class="math notranslate nohighlight">\(x_1\)</span> onto <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(y_0\)</span>.
Likewise,
we can express the <span class="math notranslate nohighlight">\(y\)</span>-axis of Frame 1 w.r.t. Frame 0
by projecting <span class="math notranslate nohighlight">\(y_1\)</span> onto <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(y_0\)</span>.
Because all of these vectors are unit vectors,
the projections can be achieved using the dot product:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
x_{1}^{0}=
\begin{bmatrix}
x_1 \cdot x_0 \\
x_1 \cdot y_0
\end{bmatrix}=
\begin{bmatrix}
\cos \theta \\
\sin \theta
\end{bmatrix}
~~~~~~~~~~~
y_{1}^{0}=
\begin{bmatrix}
y_1 \cdot x_0 \\
y_1 \cdot y_0
\end{bmatrix}=
\begin{bmatrix}
-\sin \theta \\
\cos \theta
\end{bmatrix}
\end{split}\]</div>
<p>Above, we adopt the notational convention that a subscript indicates the target
frame, and the superscript indicates the reference frame.
Thus, <span class="math notranslate nohighlight">\(x_1^0\)</span> denotes the <span class="math notranslate nohighlight">\(x\)</span>-axis of Frame 1, expressed in coordinates relative to Frame 0.</p>
<p>We can group these two vectors into a <strong>rotation matrix</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
R_{1}^{0}
=\begin{bmatrix}
x_1 \cdot x_0 &amp;  y_1 \cdot x_0\\
x_1 \cdot y_0 &amp; y_1 \cdot y_0
\end{bmatrix}
=\begin{bmatrix}
\cos \theta &amp;  -\sin \theta\\
\sin \theta &amp; \cos \theta
\end{bmatrix}
\end{split}\]</div>
<p>that describes the orientation of Frame 1 w.r.t. Frame 0.
Using the notational convention defined above, <span class="math notranslate nohighlight">\(R_{1}^{0}\)</span> indicates the reference frame
as the superscript (Frame 0) and the target frame as the subscript (Frame 1).</p>
</section>
<section id="the-special-orthogonal-group-of-order-2-aka-so-2">
<h2><span class="section-number">6.1.2. </span>The Special Orthogonal Group of Order 2, aka SO(2)<a class="headerlink" href="#the-special-orthogonal-group-of-order-2-aka-so-2" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p>Rotation matrices form a group.</p>
</div></blockquote>
<p>The set of <span class="math notranslate nohighlight">\(2\times2\)</span> rotation matrices, together with matrix multiplication as the
composition operator, form a <em>group</em> called the <strong>Special Orthogonal group of order 2</strong>,
denoted by <span class="math notranslate nohighlight">\(SO(2)\)</span>.
All matrices <span class="math notranslate nohighlight">\(R \in SO(2)\)</span> have the following properties:</p>
<ol class="arabic simple">
<li><p>Each column <span class="math notranslate nohighlight">\(c_i\)</span> is a unit vector.</p></li>
<li><p>The columns are orthogonal (i.e., <span class="math notranslate nohighlight">\(c_i \cdot c_j = 0\)</span> for <span class="math notranslate nohighlight">\(i \neq j\)</span>).</p></li>
<li><p>The inverse of <span class="math notranslate nohighlight">\(R\)</span> is equal to its transpose, <span class="math notranslate nohighlight">\(R^{-1}=R^{T}\)</span>.</p></li>
<li><p>The determinant of <span class="math notranslate nohighlight">\(R\)</span> is +1.</p></li>
</ol>
<p>The first three properties hold for all orthogonal matrices.</p>
<p>It is easy to understand the first two properties by thinking of the columns
as representations of coordinate axes. We typically use unit vectors to represent
the directions of coordinate axes, and any two coordinate axes are orthogonal to one
another.</p>
<p>The third property provides a simple method for inverting rotation matrices,
which is a frequently used operation in robotics applications.</p>
<p>The fourth property holds for rotation matrices, but not for arbitrary orthogonal
matrices.
The determinant of an arbitrary orthogonal matrix is <span class="math notranslate nohighlight">\(\pm 1\)</span>.
Those orthogonal matrices with determinant <span class="math notranslate nohighlight">\(+1\)</span> correspond to right-handed coordinate systems
(when curling the fingers of your right hand from the <span class="math notranslate nohighlight">\(x\)</span>-axis to the <span class="math notranslate nohighlight">\(y\)</span>-axis, your thumb points
in the direction of the <span class="math notranslate nohighlight">\(z\)</span>-axis, which is “out of the page” in the 2D case).
Those orthogonal matrices with determinant <span class="math notranslate nohighlight">\(-1\)</span> correspond to left-handed systems,
which are useful in computer graphics applications, but not so much for roboticists.
Note that it is this fourth property that justifies the designation <em>special</em> for this
set of matrices.</p>
<p>As we will see in the next chapter, all of the properties described above generalize to the case
of rotations in 3D, and the corresponding group of 3D rotation matrices, <span class="math notranslate nohighlight">\(SO(3)\)</span>.</p>
</section>
<section id="coordinate-transformations-for-pure-rotations">
<h2><span class="section-number">6.1.3. </span>Coordinate Transformations for Pure Rotations<a class="headerlink" href="#coordinate-transformations-for-pure-rotations" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p>The rotation group acts on 2D points.</p>
</div></blockquote>
<figure id="fig:2drotation-trans">
<img src="https://github.com/gtbook/robotics/blob/main/Figures6/2d-rotation-transformation.png?raw=1" style="width:10cm" alt="">
<figcaption>Coordinate transformation under pure rotation.</figcaption>
</figure>
<p>We can use rotation matrices to perform coordinate transformations under pure rotation.
Consider a point <span class="math notranslate nohighlight">\(P\)</span> that is rigidly attached to Frame 1 and, as illustrated in the Figures above, whose coordinates w.r.t. Frame 1
are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
P_{}^{1}=\begin{bmatrix}
p_x \\
p_y
\end{bmatrix}
\end{split}\]</div>
<p>Using the definition of coordinates, we can describe the point <span class="math notranslate nohighlight">\(P\)</span>
using the equation</p>
<div class="math notranslate nohighlight">
\[
P = p_x x_1 + p_y y_1
\]</div>
<p>in which <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(y_1\)</span> are the vectors defining the coordinate axes of Frame 1.</p>
<p>To compute the coordinates of <span class="math notranslate nohighlight">\(P\)</span> w.r.t. Frame 0, we merely project <span class="math notranslate nohighlight">\(P\)</span> onto the <span class="math notranslate nohighlight">\(x\)</span>- and <span class="math notranslate nohighlight">\(y\)</span>- axes
of Frame 0. Since the vectors <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(y_0\)</span> are unit vectors, this projection can again be accomplished
using a the dot product:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
P^0 = 
\begin{bmatrix}
P \cdot x_0 \\
P \cdot y_0
\end{bmatrix}
=
\begin{bmatrix}
(p_x x_1 + p_y y_1) \cdot x_0 \\
(p_x x_1 + p_y y_1) \cdot y_0
\end{bmatrix} 
=
\begin{bmatrix}
p_x (x_1 \cdot x_0) + p_y(y_1 \cdot x_0)   \\
p_x (x_1 \cdot y_0) + p_y(y_1 \cdot y_0)  
\end{bmatrix}
=
\begin{bmatrix}
x_1 \cdot x_0  &amp; y_1 \cdot x_0   \\
x_1 \cdot y_0  &amp; y_1 \cdot y_0  
\end{bmatrix}
\begin{bmatrix}
p_x    \\
 p_y
\end{bmatrix}
= R^0_1 P^1
\end{split}\]</div>
<p>Summarizing the above, we have</p>
<div class="math notranslate nohighlight">
\[
P^0 =  R^0_1 P^1
\]</div>
<p>which is how a rotation <span class="math notranslate nohighlight">\(R^0_1\)</span> <em>acts</em> on a point <span class="math notranslate nohighlight">\(P^1\)</span>.</p>
</section>
<section id="the-group-so-2-in-gtsam">
<h2><span class="section-number">6.1.4. </span>The Group <span class="math notranslate nohighlight">\(SO(2)\)</span> in GTSAM<a class="headerlink" href="#the-group-so-2-in-gtsam" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Rot2</span></code> is a group, and acts on <code class="docutils literal notranslate"><span class="pre">Point2</span></code>.</p>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(SO(2)\)</span> is a <em>group</em>, in the mathematical sense.
A <strong>group</strong> consists of a set (in our case, a set of 2D rotations) along
with a group operator (in our case, composition).
All groups posses certain properties, sometimes called the <em>group axioms</em>.
For the group, <span class="math notranslate nohighlight">\(SO(2)\)</span> these properties are as follows:</p>
<ol class="arabic simple">
<li><p><strong>Closure</strong>: For all rotations <span class="math notranslate nohighlight">\(R, R' \in SO(2)\)</span>, their product is also in <span class="math notranslate nohighlight">\(SO(2)\)</span>, i.e., <span class="math notranslate nohighlight">\(RR' \in SO(2)\)</span>.</p></li>
<li><p><strong>Identity Element</strong>: The <span class="math notranslate nohighlight">\(2\times 2\)</span> identity matrix <span class="math notranslate nohighlight">\(I\)</span> is included in the group, and for
all <span class="math notranslate nohighlight">\(R\in SO(2)\)</span> we have <span class="math notranslate nohighlight">\(RI = IR = R\)</span>.</p></li>
<li><p><strong>Inverse</strong>: For every <span class="math notranslate nohighlight">\(R \in SO(2)\)</span> there exists <span class="math notranslate nohighlight">\(R^{-1} \in SO(2)\)</span> such that <span class="math notranslate nohighlight">\(R^{-1}R = RR^{-1} = I\)</span>.</p></li>
<li><p><strong>Associativity</strong>: For all <span class="math notranslate nohighlight">\(R_1, R_2, R_3 \in SO(2)\)</span>, <span class="math notranslate nohighlight">\((R_1 R_2) R_3 = R_1 (R_2 R_3)\)</span>.</p></li>
</ol>
<p>In addition (only in 2D!) rotations in <span class="math notranslate nohighlight">\(SO(2)\)</span> <em>commute</em>:</p>
<ol class="arabic simple" start="5">
<li><p><strong>Commutativity</strong>: For all <span class="math notranslate nohighlight">\(R_1, R_2 \in SO(2)\)</span>, <span class="math notranslate nohighlight">\(R_1 R_2 = R_2 R_1\)</span>.</p></li>
</ol>
<p>It will not surprise anyone by now that all of this is built into GTSAM. In particular, the 2-D rotations are represented by the type <code class="docutils literal notranslate"><span class="pre">Rot2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Rot2</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">matrix</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.8660254 -0.5      ]
 [ 0.5        0.8660254]]
</pre></div>
</div>
</div>
</div>
<p>Rotations in 2D form a <em>commutative</em> group, as demonstrated here in code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">R</span><span class="p">,</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Rot2</span><span class="p">))</span> <span class="c1"># closure</span>
<span class="n">I2</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Rot2</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">I2</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># identity</span>
<span class="nb">print</span><span class="p">((</span><span class="n">R</span> <span class="o">*</span> <span class="n">R</span><span class="o">.</span><span class="n">inverse</span><span class="p">())</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">I2</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># inverse</span>
<span class="n">R1</span><span class="p">,</span> <span class="n">R2</span><span class="p">,</span> <span class="n">R3</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Rot2</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Rot2</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Rot2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(((</span><span class="n">R1</span> <span class="o">*</span> <span class="n">R2</span><span class="p">)</span><span class="o">*</span> <span class="n">R3</span><span class="p">)</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">R1</span> <span class="o">*</span> <span class="p">(</span><span class="n">R2</span> <span class="o">*</span> <span class="n">R3</span><span class="p">),</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># associative</span>
<span class="nb">print</span><span class="p">((</span><span class="n">R1</span> <span class="o">*</span> <span class="n">R2</span><span class="p">)</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">R2</span> <span class="o">*</span> <span class="n">R1</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># commutative</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
True
True
True
True
</pre></div>
</div>
</div>
</div>
<p>Finally, rotations can act on points, which we can do using matrix multiplication, or using the <code class="docutils literal notranslate"><span class="pre">Rot2.rotate</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R01</span> <span class="o">=</span>  <span class="n">gtsam</span><span class="o">.</span><span class="n">Rot2</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="n">P1</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Point2</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P0 = </span><span class="si">{</span><span class="n">R01</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">P1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P0 = </span><span class="si">{</span><span class="n">R01</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">P1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P0 = [2.73271005 4.18715844]
P0 = [2.73271005 4.18715844]
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-rigid-transforms-aka-se-2">
<h2><span class="section-number">6.1.5. </span>2D Rigid Transforms aka SE(2)<a class="headerlink" href="#d-rigid-transforms-aka-se-2" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p>From <span class="math notranslate nohighlight">\(SO(2)\)</span> to <span class="math notranslate nohighlight">\(SE(2)\)</span>.</p>
</div></blockquote>
<p><strong>2D rigid transforms</strong> combine rotation with translation, and are used in two <em>different</em> ways in robotics:</p>
<ul class="simple">
<li><p>to specify the <strong>pose</strong> of a robot, which consists of a translation and an orientation</p></li>
<li><p>to talk about relative pose or the <strong>transformation</strong> between two different robot poses</p></li>
</ul>
<p>We can use the same mathematical object for both use cases, i.e., 2D rigid transforms <span class="math notranslate nohighlight">\(T\in SE(2)\)</span>, which combine translation and orientation in a <span class="math notranslate nohighlight">\(3 \times 3\)</span> matrix, as explained below.</p>
<figure id="fig:2drotation-trans">
<img src="https://github.com/gtbook/robotics/blob/main/Figures6/2d-coord-trans.png?raw=1" style="width:20cm" alt="">
<figcaption>Coordinate transformation under both rotation and translation.</figcaption>
</figure>
<p>Let us start by assuming as before that the point <span class="math notranslate nohighlight">\(P\)</span> is rigidly attached to a frame that is rotated
by angle <span class="math notranslate nohighlight">\(\theta\)</span> w.r.t. Frame 0.
If we now translate that frame according to a vector <span class="math notranslate nohighlight">\(d\)</span>, as shown in the figure above, the point <span class="math notranslate nohighlight">\(P\)</span> undergoes
the same translation as the frame.
To calculate the coordinates of <span class="math notranslate nohighlight">\(P\)</span> relative to Frame 0, we merely
perform the rotational coordinate transformation as above,
and then add the translation from the origin of Frame 0 to the origin of Frame 1:</p>
<div class="math notranslate nohighlight">
\[
P^0 =  R^0_1 P^1 + d^0_1
\]</div>
<p>We can write the above coordinate transformation as a matrix equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
P^0 \\ 1
\end{bmatrix}
=
\begin{bmatrix}
R_{1}^{0} &amp; d_{1}^{0}\\
0_{2} &amp; 1
\end{bmatrix}
\begin{bmatrix}
P^1 \\ 1
\end{bmatrix}
\end{split}\]</div>
<p>in which <span class="math notranslate nohighlight">\(0_2\)</span> denotes the row vector <span class="math notranslate nohighlight">\([0~ 0]\)</span>.
Note that the bottom row of this matrix equation is merely the equation</p>
<div class="math notranslate nohighlight">
\[\begin{split}
1 = \begin{bmatrix} 0 &amp; 0 &amp; 1 \end{bmatrix} 
\begin{bmatrix} p_x \\ p_y \\ 1 \end{bmatrix}
\end{split}\]</div>
<p>which holds for any <span class="math notranslate nohighlight">\(p_x, p_y\)</span>.</p>
<p>It is convenient to define the 3-vector <span class="math notranslate nohighlight">\(\tilde{P}\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\tilde{P} =
\begin{bmatrix}
P \\ 1
\end{bmatrix}
\end{split}\]</div>
<p>which we call the homogeneous coordinates of the point <span class="math notranslate nohighlight">\(P\)</span>.
Using this convention, we can write the <em>homogeneous coordinate transformation</em> as</p>
<div class="math notranslate nohighlight">
\[
\tilde{P}^0 = T^0_1 \tilde{P}^1
\]</div>
<p>The set of matrices of the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
T =
\begin{bmatrix}
R &amp; d\\
0_2 &amp; 1
\end{bmatrix}
\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(R \in SO(2)\)</span> and <span class="math notranslate nohighlight">\(d \in \mathbb{R}^2\)</span> is called
the <strong>special Euclidean group of order 2</strong>, denoted by SE(2).</p>
</section>
<section id="composition-of-homogeneous-transformations">
<h2><span class="section-number">6.1.6. </span>Composition of Homogeneous Transformations<a class="headerlink" href="#composition-of-homogeneous-transformations" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p>We can implement composition by matrix multiplication.</p>
</div></blockquote>
<figure id="fig:TransformComposition">
<img src="https://github.com/gtbook/robotics/blob/main/Figures6/transform-composition.png?raw=1" style="width:14cm" alt="">
<figcaption>The composition of two homogeneous transformations. </figcaption>
</figure>
<p>Consider a mobile robot that begins at some initial configuration, moves to a new location, reorients itself and then moves to another location. How can we determine the final configuration of the robot if we are given
only the individual motions in the sequence?
The answer is suprisingly simple.
Suppose the point <span class="math notranslate nohighlight">\(P\)</span> is rigidly attached to the robot.
Using the coordinate transformation equation <span class="math notranslate nohighlight">\(\tilde{P}^i = T^i_j \tilde{P}^j\)</span>, we have the following:</p>
<div class="math notranslate nohighlight">
\[\tilde{P}^0 = T^0_1 \tilde{P}^1, ~~~~~ \tilde{P}^1 = T^1_2 \tilde{P}^2, ~~~~~ \tilde{P}^0 = T^0_2 \tilde{P}^2\]</div>
<p>Combining the first two of these gives</p>
<div class="math notranslate nohighlight">
\[\tilde{P}^0 = T^0_1 T^1_2 \tilde{P}^2\]</div>
<p>and since this equation holds for every possible <span class="math notranslate nohighlight">\(\tilde{P}^2\)</span> we have</p>
<div class="math notranslate nohighlight">
\[T^0_2 = T^0_1 T^1_2 \]</div>
<p>It is easy to show (by induction) that this result extends to an arbitarily long sequence of transformations.
Therefore, if we have a sequence of robot configurations <span class="math notranslate nohighlight">\(T^{i-1}_i\)</span>, for <span class="math notranslate nohighlight">\(i = 1, \dots , n\)</span> we can compute
the composite transformation <span class="math notranslate nohighlight">\(T^0_n\)</span> using</p>
<div class="math notranslate nohighlight">
\[T^0_n = T^0_1 \dots T^{n-1}_n \]</div>
</section>
<section id="the-group-se-2-in-gtsam">
<h2><span class="section-number">6.1.7. </span>The Group <span class="math notranslate nohighlight">\(SE(2)\)</span> in GTSAM<a class="headerlink" href="#the-group-se-2-in-gtsam" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Pose2</span></code> is a <em>non-commutative</em> group, and also acts on <code class="docutils literal notranslate"><span class="pre">Point2</span></code>.</p>
</div></blockquote>
<p>Unsurprisingly, <span class="math notranslate nohighlight">\(SE(2)\)</span> is also a group, as the following properties all hold:</p>
<ol class="arabic simple">
<li><p><strong>Closure</strong>: For all transforms <span class="math notranslate nohighlight">\(T, T' \in SE(2)\)</span>, their product is also in <span class="math notranslate nohighlight">\(SE(2)\)</span>, i.e., <span class="math notranslate nohighlight">\(T T' \in SE(2)\)</span>.</p></li>
<li><p><strong>Identity Element</strong>: The <span class="math notranslate nohighlight">\(3\times 3\)</span> identity matrix <span class="math notranslate nohighlight">\(I\)</span> is included in the group, and for
all <span class="math notranslate nohighlight">\(T \in SE(2)\)</span> we have <span class="math notranslate nohighlight">\(T I = I T = T\)</span>.</p></li>
<li><p><strong>Inverse</strong>: For every <span class="math notranslate nohighlight">\(T \in SE(2)\)</span> there exists <span class="math notranslate nohighlight">\(T^{-1} \in SE(2)\)</span> such that <span class="math notranslate nohighlight">\(T^{-1}T = T T^{-1} = I\)</span>.</p></li>
<li><p><strong>Associativity</strong>: For all <span class="math notranslate nohighlight">\(T_1, T_2, T_3 \in SE(2)\)</span>, <span class="math notranslate nohighlight">\((T_1 T_2) T_3 = T_1 (T_2 T_3)\)</span>.</p></li>
</ol>
<p>However, in contrast to 2D rotations, 2D rigid transforms do <em>not</em> commute. Also, The inverse <span class="math notranslate nohighlight">\(T^{-1}\)</span> is not just the transpose; instead, we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
T^{-1} = \begin{bmatrix}R &amp; d\\0_2 &amp; 1\end{bmatrix}^{-1}
 = \begin{bmatrix}R^T &amp; -R^T d\\0_2 &amp; 1\end{bmatrix}
\end{split}\]</div>
<p>which you can easily verify by multiplying to obtain <span class="math notranslate nohighlight">\(I\)</span>.</p>
<p>Again, all of this is built into GTSAM,where both 2D poses and 2D rigid transforms are represented by the type <code class="docutils literal notranslate"><span class="pre">Pose2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose2</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D Pose (x, y, theta) = </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2">corresponding to transformation matrix:</span><span class="se">\n</span><span class="si">{</span><span class="n">T</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2D Pose (x, y, theta) = (3, -2, 0.523599)
corresponding to transformation matrix:
[[ 0.8660254 -0.5        3.       ]
 [ 0.5        0.8660254 -2.       ]
 [ 0.         0.         1.       ]]
</pre></div>
</div>
</div>
</div>
<p>2D transforms form a <em>non-commutative</em> group, as demonstrated here in code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">T</span><span class="p">,</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose2</span><span class="p">))</span> <span class="c1"># closure</span>
<span class="n">I3</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose2</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">I3</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># identity</span>
<span class="nb">print</span><span class="p">((</span><span class="n">T</span> <span class="o">*</span> <span class="n">T</span><span class="o">.</span><span class="n">inverse</span><span class="p">())</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">I3</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># inverse</span>
<span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">T3</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose2</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose2</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(((</span><span class="n">T1</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span><span class="o">*</span> <span class="n">T3</span><span class="p">)</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">T1</span> <span class="o">*</span> <span class="p">(</span><span class="n">T2</span> <span class="o">*</span> <span class="n">T3</span><span class="p">),</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># associative</span>
<span class="nb">print</span><span class="p">((</span><span class="n">T1</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">T2</span> <span class="o">*</span> <span class="n">T1</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">))</span> <span class="c1"># NOT commutative</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
True
True
True
False
</pre></div>
</div>
</div>
</div>
<p>Finally, 2D transforms can act on points, which we can do using matrix multiplication, or using the <code class="docutils literal notranslate"><span class="pre">Pose2.transformFrom</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T01</span> <span class="o">=</span>  <span class="n">gtsam</span><span class="o">.</span><span class="n">Pose2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="n">P1</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Point2</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P0 = </span><span class="si">{</span><span class="n">T01</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># need to make P0 homogeneous</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P0 = </span><span class="si">{</span><span class="n">T01</span><span class="o">.</span><span class="n">transformFrom</span><span class="p">(</span><span class="n">P1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P0 = [3.73271005 6.18715844 1.        ]
P0 = [3.73271005 6.18715844]
</pre></div>
</div>
</div>
</div>
</section>
<section id="lie-groups">
<h2><span class="section-number">6.1.8. </span>Lie Groups*<a class="headerlink" href="#lie-groups" title="Permalink to this heading">#</a></h2>
<p>Groups can be either discrete or continuous.
For example, the set of integers along with addition as the group operation and zero as the identity forms a discrete
group.
In contrast, both <span class="math notranslate nohighlight">\(SO(2)\)</span> and <span class="math notranslate nohighlight">\(SE(2)\)</span> are continuous groups.
Not only are they continuous, but they are examples of <strong>manifolds</strong>.
Informally, a manifold is a set that is locally like <span class="math notranslate nohighlight">\(\mathbb{R}^k\)</span> for some <span class="math notranslate nohighlight">\(k\)</span>.
In the present case, <span class="math notranslate nohighlight">\(SO(2)\)</span> is locally like <span class="math notranslate nohighlight">\(\mathbb{R}^1\)</span>, and <span class="math notranslate nohighlight">\(SE(2)\)</span> is locally like <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>.</p>
<p>While the topic of manifolds is beyond the scope of this book,
the easiest way to understand this is to note that <span class="math notranslate nohighlight">\(SO(2)\)</span> can be parameterized by the angle <span class="math notranslate nohighlight">\(\theta \in [0,2\pi) \subset \mathbb{R}^1\)</span>.
This parameterization is local (and not global) because it breaks down in a neighborhood of <span class="math notranslate nohighlight">\(\theta = 2\pi\)</span> (as described above).
This is not a problem, however, since in that case, we can simply
choose to use <span class="math notranslate nohighlight">\(\theta \in [-\pi, \pi)\)</span> instead of <span class="math notranslate nohighlight">\(\theta \in [0,2\pi)\)</span>.
We can completely <em>cover</em> <span class="math notranslate nohighlight">\(SO(2)\)</span> using two parameterizations: one for cases when <span class="math notranslate nohighlight">\(\theta\)</span> is near <span class="math notranslate nohighlight">\(2\pi\)</span>,
and a second for when <span class="math notranslate nohighlight">\(\theta\)</span> is near <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>For the case of <span class="math notranslate nohighlight">\(SE(2)\)</span>, we merely use the two parameterizations <span class="math notranslate nohighlight">\((x,y,\theta) \in \mathbb{R}^2 \times [0,2\pi) \subset \mathbb{R}^3\)</span>
and <span class="math notranslate nohighlight">\((x,y,\theta) \in \mathbb{R}^2 \times [-\pi,\pi) \subset \mathbb{R}^3\)</span>,
which demonstrates that <em>locally</em> <span class="math notranslate nohighlight">\(SE(2)\)</span> is like <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>.</p>
<p>In addition to being manifolds, both <span class="math notranslate nohighlight">\(SO(2)\)</span> and <span class="math notranslate nohighlight">\(SE(2)\)</span> posses the additional property of being differentiable.
Such groups are known as <strong>Lie groups</strong> (pronounced “Lee groups”).
While again beyond the scope of this book,
we can understand this by considering the parameterizations for <span class="math notranslate nohighlight">\(SO(2)\)</span> and <span class="math notranslate nohighlight">\(SE(2)\)</span> described above.
For each of these parameterizations, we can differentiate the elements of <span class="math notranslate nohighlight">\(SO(2)\)</span> and <span class="math notranslate nohighlight">\(SE(2)\)</span>,
which implies the existence of linear and angular velocities.
In fact, in this chapter, we will define the actions of the car using these velocities as
the inputs to the system.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="S60_driving_intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Autonomous Vehicles</p>
      </div>
    </a>
    <a class="right-next"
       href="S62_driving_actions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.2. </span>Kinematics for Driving</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#planar-rotations">6.1.1. Planar Rotations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-special-orthogonal-group-of-order-2-aka-so-2">6.1.2. The Special Orthogonal Group of Order 2, aka SO(2)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-transformations-for-pure-rotations">6.1.3. Coordinate Transformations for Pure Rotations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-group-so-2-in-gtsam">6.1.4. The Group <span class="math notranslate nohighlight">\(SO(2)\)</span> in GTSAM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-rigid-transforms-aka-se-2">6.1.5. 2D Rigid Transforms aka SE(2)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#composition-of-homogeneous-transformations">6.1.6. Composition of Homogeneous Transformations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-group-se-2-in-gtsam">6.1.7. The Group <span class="math notranslate nohighlight">\(SE(2)\)</span> in GTSAM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lie-groups">6.1.8. Lie Groups*</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Frank Dellaert and Seth Hutchinson
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>