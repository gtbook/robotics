
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.3. Sensor Models with Continuous State &#8212; Introduction to Robotics and Perception</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/style.css?v=51e3b7cf" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=c73c0f3e"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'S43_logistics_sensing';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4.4. Localization" href="S44_logistics_perception.html" />
    <link rel="prev" title="4.2. Moving in 2D" href="S42_logistics_actions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Introduction to Robotics and Perception - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Introduction to Robotics and Perception - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="S10_introduction.html">1. Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S11_models.html">1.1. Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="S12_reasoning.html">1.2. Reasoning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S13_math.html">1.3. The Mathematics of Robotics</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S20_sorter_intro.html">2. A Trash Sorting Robot</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S21_sorter_state.html">2.1. Modeling the World State</a></li>
<li class="toctree-l2"><a class="reference internal" href="S22_sorter_actions.html">2.2. Actions for Sorting Trash</a></li>
<li class="toctree-l2"><a class="reference internal" href="S23_sorter_sensing.html">2.3. Sensors for Sorting Trash</a></li>
<li class="toctree-l2"><a class="reference internal" href="S24_sorter_perception.html">2.4. Perception</a></li>
<li class="toctree-l2"><a class="reference internal" href="S25_sorter_decision_theory.html">2.5. Decision Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="S26_sorter_learning.html">2.6. Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S27_sorter_summary.html">2.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S30_vacuum_intro.html">3. A Robot Vacuum Cleaner</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S31_vacuum_state.html">3.1. Modeling the State of the Vacuum Cleaning Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="S32_vacuum_actions.html">3.2. Actions over time</a></li>
<li class="toctree-l2"><a class="reference internal" href="S33_vacuum_sensing.html">3.3. Dynamic Bayesian Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="S34_vacuum_perception.html">3.4. Perception with Graphical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="S35_vacuum_decision.html">3.5. Markov Decision Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="S36_vacuum_RL.html">3.6. Learning to Act Optimally</a></li>
<li class="toctree-l2"><a class="reference internal" href="S37_vacuum_summary.html">3.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="S40_logistics_intro.html">4. Warehouse Robots in 2D</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="S41_logistics_state.html">4.1. Continuous State</a></li>
<li class="toctree-l2"><a class="reference internal" href="S42_logistics_actions.html">4.2. Moving in 2D</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">4.3. Sensor Models with Continuous State</a></li>
<li class="toctree-l2"><a class="reference internal" href="S44_logistics_perception.html">4.4. Localization</a></li>
<li class="toctree-l2"><a class="reference internal" href="S45_logistics_planning.html">4.5. Planning for Logistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="S46_logistics_learning.html">4.6. Some System Identification</a></li>
<li class="toctree-l2"><a class="reference internal" href="S47_logistics_summary.html">4.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S50_diffdrive_intro.html">5. A Mobile Robot With Simple Kinematics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S51_diffdrive_state.html">5.1. State Space for a Differential Drive Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="S52_diffdrive_actions.html">5.2. Motion Model for the Differential Drive Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="S53_diffdrive_sensing.html">5.3. Robot Vision</a></li>
<li class="toctree-l2"><a class="reference internal" href="S54_diffdrive_perception.html">5.4. Computer Vision 101</a></li>
<li class="toctree-l2"><a class="reference internal" href="S55_diffdrive_planning.html">5.5. Path Planning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S56_diffdrive_learning.html">5.6. Deep Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S57_diffdrive_summary.html">5.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S60_driving_intro.html">6. Autonomous Vehicles</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S61_driving_state.html">6.1. Planar Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="S62_driving_actions.html">6.2. Kinematics for Driving</a></li>
<li class="toctree-l2"><a class="reference internal" href="S63_driving_sensing.html">6.3. Sensing for Autonomous Vehicles</a></li>
<li class="toctree-l2"><a class="reference internal" href="S64_driving_perception.html">6.4. SLAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="S65_driving_planning.html">6.5. Planning for Autonomous Driving.</a></li>
<li class="toctree-l2"><a class="reference internal" href="S66_driving_DRL.html">6.6. Deep Reinforcement Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S67_driving_summary.html">6.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S70_drone_intro.html">7. Autonomous Drones in 3D</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S71_drone_state.html">7.1. Moving in Three Dimensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="S72_drone_actions.html">7.2. Multi-rotor Aircraft</a></li>
<li class="toctree-l2"><a class="reference internal" href="S73_drone_sensing.html">7.3. Sensing for Drones</a></li>
<li class="toctree-l2"><a class="reference internal" href="S74_drone_perception.html">7.4. Visual SLAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="S75_drone_planning.html">7.5. Trajectory Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="S76_drone_learning.html">7.6. Neural Radiance Fields for Drones</a></li>
<li class="toctree-l2"><a class="reference internal" href="S77_drone_summary.html">7.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">8. Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/S43_logistics_sensing.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sensor Models with Continuous State</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-proximity-sensor">4.3.1. A proximity sensor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-range-sensor">4.3.2. A Range Sensor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-case-of-no-beacons-in-sensing-range">4.3.3. The Case of No Beacons in Sensing Range</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-gps-like-location-sensor">4.3.4. A GPS-Like Location Sensor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-states-and-measurements">4.3.5. Simulating States <em>and</em> Measurements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gps-style-likelihoods">4.3.6. GPS-style Likelihoods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gtbook-101">4.3.7. GTbook 101</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="sensor-models-with-continuous-state">
<h1><span class="section-number">4.3. </span>Sensor Models with Continuous State<a class="headerlink" href="#sensor-models-with-continuous-state" title="Link to this heading">#</a></h1>
<p><a href="https://colab.research.google.com/github/gtbook/robotics/blob/main/S43_logistics_sensing.ipynb" target="_parent"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<blockquote id="index-0">
<div><p>From Gaussian to non-Gaussian sensors.</p>
</div></blockquote>
<a class="reference internal image-reference" href="_images/S43-Warehouse_robots-08.jpg"><img alt="Splash image with warehouse robot surrounded by sensor-like implements" class="align-center" src="_images/S43-Warehouse_robots-08.jpg" style="width: 40%;" /></a>
<p>In the previous chapters, we have used sensors that could be characterized using fairly simple probabilistic
models, either discrete conditional probability distributions (e.g., conductivity for the trash-sorting robot
and light sensing for the vacuum cleaning robot), or one-dimensional Gaussian distributions (as for the trash-sorting robot’s weight sensor).  In this section we introduce three more realistic sensors,
each of which are similar to sensors that are frequently used in modern robotic systems:</p>
<ul class="simple">
<li><p>a proximity sensor</p></li>
<li><p>an RFID range sensor, which has a non-linear measurement prediction model</p></li>
<li><p>a GPS-like location sensor, which uses a Gaussian conditional density</p></li>
</ul>
<p>The proximity sensor detects when the robot is near an obstacle.
Therefore, this sensor’s response depends on the geometry of the environment.
Let us extend the example from the Section 4.1, a warehouse of 100m x 50m, by imagining four sets of shelves placed at regular intervals.</p>
<p>We can represent this in code using a 2D image. We can simply use a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array to do so, and indeed this is what we do. A base map for this environment is defined in <code class="docutils literal notranslate"><span class="pre">gtbook.logistics</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_map</span> <span class="o">=</span> <span class="n">logistics</span><span class="o">.</span><span class="n">base_map</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;type(base_map):&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">base_map</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;base_map.dtype:&quot;</span><span class="p">,</span> <span class="n">base_map</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;base_map.shape:&quot;</span><span class="p">,</span> <span class="n">base_map</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>type(base_map): &lt;class &#39;numpy.ndarray&#39;&gt;
base_map.dtype: float64
base_map.shape: (50, 100)
</pre></div>
</div>
</div>
</div>
<p>Below we plot this <code class="docutils literal notranslate"><span class="pre">base_map</span></code> as an image, using the conveniently defined <code class="docutils literal notranslate"><span class="pre">show_map</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| caption: The logistics warehouse base map that we use throughout this section.</span>
<span class="c1">#| label: fig:logistics_base_map</span>
<span class="n">logistics</span><span class="o">.</span><span class="n">show_map</span><span class="p">(</span><span class="n">base_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/37ef1e86ecaa14b535b04e381929d4384c1c29d3ffbaa3ef845f10fecd8c1252.png" src="_images/37ef1e86ecaa14b535b04e381929d4384c1c29d3ffbaa3ef845f10fecd8c1252.png" />
</div>
</div>
<p>In the remainder of this section we then show how to use this map to simulate the three sensors we listed above.</p>
<section id="a-proximity-sensor">
<h2><span class="section-number">4.3.1. </span>A proximity sensor<a class="headerlink" href="#a-proximity-sensor" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>A binary sensor over a continuous space.</p>
</div></blockquote>
<p>We consider a sensor that measures the <em>proximity</em> of the robot to obstacles. For example, this could be operationalized using small infrared sensor/receiver pairs, or a magnetic sensor that measures proximity to one of the metal structures within the warehouse.</p>
<p>This is a <em>binary</em> sensor, just like the conductivity sensor we saw in the trash sorting example. However, a big difference is that the measurement <span class="math notranslate nohighlight">\(z_k\)</span> of this sensor at time <span class="math notranslate nohighlight">\(k\)</span> depends on the <em>continuous</em> state <span class="math notranslate nohighlight">\(x_k\)</span>.
In other words, this is a kind of <em>hybrid</em>, discrete-continuous sensor model.</p>
<p id="index-1">This sensor can be modeled using a <strong>signed distance function</strong> or <strong>SDF</strong>, which is a well-known concept from graphics.
An SDF measures the distance from any point <span class="math notranslate nohighlight">\(x\)</span> to the nearest obstacle, is positive if this location is outside the obstacle, and negative if it is inside the obstacle. Robots will never see negative SDF values.
Let <span class="math notranslate nohighlight">\(X_{obs}\)</span> denote the set of points on the boundary of the obstacles (the borders of the shelves, and the
walls that enclose the warehouse).
For a given point <span class="math notranslate nohighlight">\(x \in {\cal D}\)</span>, the distance to the nearest obstacle can be defined by</p>
<div class="amsmath math notranslate nohighlight" id="equation-8f9b6944-d15a-4387-a84d-087d4bc51f26">
<span class="eqno">(4.25)<a class="headerlink" href="#equation-8f9b6944-d15a-4387-a84d-087d4bc51f26" title="Permalink to this equation">#</a></span>\[\begin{equation}
d(x) = \min_{y \in X_{obs}} \|x - y\|
\end{equation}\]</div>
<p>We now define the signed distance to be negative for <span class="math notranslate nohighlight">\(x\)</span> is inside the obstacle, and positive for points outside the obstacle:</p>
<div class="amsmath math notranslate nohighlight" id="equation-2fdf8407-e35e-4beb-b7af-ecfda7942372">
<span class="eqno">(4.26)<a class="headerlink" href="#equation-2fdf8407-e35e-4beb-b7af-ecfda7942372" title="Permalink to this equation">#</a></span>\[\begin{equation}
\mathop{sdf}(x)
= 
\left\{
    \begin{array}{lcr} - d(x) &amp; &amp; x \mathop{\; inside\; obstacle}\\
    + d(x) &amp; &amp; x \mathop{\; outside\;  obstacle}\\
\end{array}
\right.
\end{equation}\]</div>
<p>We can use the function <em>sdf</em> to model our proximity sensor by defining a conditional probability
distribution <span class="math notranslate nohighlight">\(P(z_k=\text{ON}|x_k)\)</span> as a function of <span class="math notranslate nohighlight">\(\mathrm{sdf}(x)\)</span>.
For example, if obstacle detection is very reliable for for <span class="math notranslate nohighlight">\(d(x) &lt; d_0\)</span>,
but degrades rapidly as <span class="math notranslate nohighlight">\(d(x)\)</span> increases (i.e., as the robot moves further from obstacles),
we might define</p>
<div class="amsmath math notranslate nohighlight" id="equation-2f7ccf6e-34e2-455f-821f-2910e479c8d1">
<span class="eqno">(4.27)<a class="headerlink" href="#equation-2f7ccf6e-34e2-455f-821f-2910e479c8d1" title="Permalink to this equation">#</a></span>\[\begin{equation}
P(z_k=\text{ON}|x_k) = 
\left\{
    \begin{array}{lcr} 1 &amp; &amp; d(x) &lt; d_0 \\
     e^{- \alpha d(x)} &amp;&amp; \mathrm{otherwise}\\
\end{array}
\right.
\end{equation}\]</div>
<p>where the value of <span class="math notranslate nohighlight">\(\alpha &gt; 0\)</span> determines how rapidly the probability decreases.
Because the conditional probability <span class="math notranslate nohighlight">\(P(\cdot | x_k)\)</span> is a valid probability distribution,
we can immediately conclude that
<span class="math notranslate nohighlight">\(P(z_k=\text{OFF}|x_k) = 1 - P(z_k=\text{ON}|x_k)\)</span>.</p>
<p>Below, we use a simpler model, which assumes that the proximity sensor perfectly
detects when the robot is within distance <span class="math notranslate nohighlight">\(d_0\)</span> of an obstacle:</p>
<div class="amsmath math notranslate nohighlight" id="equation-8c098150-18ba-458f-8d6d-6e478607e5f1">
<span class="eqno">(4.28)<a class="headerlink" href="#equation-8c098150-18ba-458f-8d6d-6e478607e5f1" title="Permalink to this equation">#</a></span>\[\begin{equation}
P(z_k=\text{ON}|x_k)
= 
\left\{
    \begin{array}{lcr} 1 &amp; &amp; d(x) &lt; d_0 \\
     0 &amp;&amp; \mathrm{otherwise}\\
\end{array}
\right.
\end{equation}\]</div>
<p>The figure below shows the likelihood for <span class="math notranslate nohighlight">\(z_k = \text{ON}\)</span>.
Recall that the likelihood <span class="math notranslate nohighlight">\(l(x_k;z_k=\text{ON})\propto P(z_k=\text{ON}|z_k)\)</span> is a function <em>of the state</em> <span class="math notranslate nohighlight">\(x_k\)</span>, so we can show it as a map:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| caption: The likelihood of locations in the map when the proximity sensor reads ON.</span>
<span class="c1">#| label: fig:logistics_proximity_map_on</span>
<span class="n">logistics</span><span class="o">.</span><span class="n">show_map</span><span class="p">(</span><span class="n">logistics</span><span class="o">.</span><span class="n">proximity_map_on</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1fef6d08d26fd0a46e135f5ca10b98c713cfee944d91c6c9e9ae708e4c6ea797.png" src="_images/1fef6d08d26fd0a46e135f5ca10b98c713cfee944d91c6c9e9ae708e4c6ea797.png" />
</div>
</div>
<p>Note that we denote a likelihood over a continuous variable with lowercase <span class="math notranslate nohighlight">\(l()\)</span>, in analogy to the lowercase <span class="math notranslate nohighlight">\(p()\)</span> we use for densities. For this specific sensor model, at any location, the likelihood <span class="math notranslate nohighlight">\(l(x_k;z_k=\text{OFF})\)</span> of <span class="math notranslate nohighlight">\(x_k\)</span> given that the sensor is OFF will be the mirror image of the map above, as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| caption: The likelihood of locations in the map when the proximity sensor reads OFF.</span>
<span class="c1">#| label: fig:logistics_proximity_map_off</span>
<span class="n">logistics</span><span class="o">.</span><span class="n">show_map</span><span class="p">(</span><span class="n">logistics</span><span class="o">.</span><span class="n">proximity_map_off</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3cbd43899f04a4173a04805d31601f82be7d1fec919d9b8310500b172ad10975.png" src="_images/3cbd43899f04a4173a04805d31601f82be7d1fec919d9b8310500b172ad10975.png" />
</div>
</div>
</section>
<section id="a-range-sensor">
<h2><span class="section-number">4.3.2. </span>A Range Sensor<a class="headerlink" href="#a-range-sensor" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>A range sensor returns the distance to a landmark.</p>
</div></blockquote>
<p>Let us assume that the operator of the warehouse has installed a number of <em>beacons</em> throughout the warehouse, at strategically placed locations. The measurement function <span class="math notranslate nohighlight">\(h(x_k; b_i)\)</span> for a sensor measuring the range to a beacon at location <span class="math notranslate nohighlight">\(b_i\)</span> is given by:</p>
<div class="amsmath math notranslate nohighlight" id="equation-aca94614-bdc8-48c3-8586-ed456a1d04ff">
<span class="eqno">(4.29)<a class="headerlink" href="#equation-aca94614-bdc8-48c3-8586-ed456a1d04ff" title="Permalink to this equation">#</a></span>\[\begin{equation}
h(x_k;b_i) = \|x_k - b_i\| = \sqrt{(x_k - b_i)^T(x_k - b_i)}
\end{equation}\]</div>
<p>The energy emitted by an RFID beacon is, of course, finite. Therefore, there is some maximal
distance, say <span class="math notranslate nohighlight">\(d_{\max}\)</span>, beyond which the sensor is unable to detect the beacon.
In this case, the sensor does not return any range measurement, and indicates
“no beacon present.”</p>
<p>This is actually not an unrealistic model;
there is a technology called <a class="reference external" href="https://en.wikipedia.org/wiki/Radio-frequency_identification">radio frequency identification (RFID)</a>, which can be detected using a small radio receiver, and some of the more expensive variants allow for the range to the RFID to be measured, if not very accurately.</p>
<p>As with the motion model described above, it is typical to assume additive Gaussian
noise for sensors, leading to the measurement model:</p>
<div class="amsmath math notranslate nohighlight" id="equation-cec6fbd6-d05e-4e56-a3a1-ee43225e2983">
<span class="eqno">(4.30)<a class="headerlink" href="#equation-cec6fbd6-d05e-4e56-a3a1-ee43225e2983" title="Permalink to this equation">#</a></span>\[\begin{equation}
z_k = h(x_k;b_i) + w_k
\end{equation}\]</div>
<p>in which <span class="math notranslate nohighlight">\(w_k\)</span> is the noise term (unrelated to the noise in our motion model).
Using this model, we see that the conditional probability of a range measurement <span class="math notranslate nohighlight">\(z_k\)</span> given a continuous state <span class="math notranslate nohighlight">\(x_k\)</span> <em>is</em> a Gaussian, even though its mean <span class="math notranslate nohighlight">\(\mu\)</span> is computed as a nonlinear function of <span class="math notranslate nohighlight">\(x_k\)</span>.</p>
<div class="amsmath math notranslate nohighlight" id="equation-450ae79f-c121-4021-9800-8344e8df6f1b">
<span class="eqno">(4.31)<a class="headerlink" href="#equation-450ae79f-c121-4021-9800-8344e8df6f1b" title="Permalink to this equation">#</a></span>\[\begin{equation}
\begin{aligned}
p(z_k|x_k; b_i) &amp;= \mathcal{N}(z_k;\mu=h(x_k;b_i), \sigma^2) \\
&amp;= \frac{1}{\sqrt{2\pi\sigma^2}} \exp\{-\frac{1}{2\sigma^2}(z_k-h(x_k;b_i))^2\}
\end{aligned}
\end{equation}\]</div>
<p>Note that the range is one-dimensional, so we again use the simpler univariate Gaussian, and we use the variance <span class="math notranslate nohighlight">\(\sigma^2\)</span> to characterize the zero-mean Gaussian noise.</p>
<p>The equation below for the <em>likelihood</em> of the state <span class="math notranslate nohighlight">\(x_k\)</span> given a measurement <span class="math notranslate nohighlight">\(z_k\)</span> (to beacon <span class="math notranslate nohighlight">\(b_i\)</span>) seems similar to a Gaussian density:</p>
<div class="amsmath math notranslate nohighlight" id="equation-8c1780b0-8dc5-4778-b705-696a8c1da4d2">
<span class="eqno">(4.32)<a class="headerlink" href="#equation-8c1780b0-8dc5-4778-b705-696a8c1da4d2" title="Permalink to this equation">#</a></span>\[\begin{equation}
L(x_k;z_k, b_i) = \exp\{-\frac{1}{2\sigma^2}(z_k-h(x_k;b_i))^2\}.
\end{equation}\]</div>
<p>However, because the likelihood is a function of <span class="math notranslate nohighlight">\(x_k\)</span>, and not a function of <span class="math notranslate nohighlight">\(z_k\)</span> (remember, <span class="math notranslate nohighlight">\(z_k\)</span> is <em>given</em>
when we compute the likelihood for state <span class="math notranslate nohighlight">\(x_k\)</span>),
the likelihood does not even remotely look like a Gaussian!
In fact, the likelihood will be high where the state agrees with the given range measurement, i.e., in an <em>annulus</em> of the right radius around the beacon. The “width” of the annulus will be proportional to the measurement noise <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<p>To make this concrete, let us add eight beacons to the base map, at either end of the shelves, which seems very useful for robot navigation. Again, we define these in <code class="docutils literal notranslate"><span class="pre">gtbook.logistics.beacons</span></code>, and we show them below on the base map:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| caption: The eight beacons in the logistics warehouse, at the locations shown in the base map.</span>
<span class="c1">#| label: fig:logistics_beacons</span>
<span class="n">logistics</span><span class="o">.</span><span class="n">show_map</span><span class="p">(</span><span class="n">base_map</span><span class="p">,</span> <span class="n">logistics</span><span class="o">.</span><span class="n">beacons</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a9b6fcd82e4f8e69fa8ff9d699a71dc0ef55eb4ac0c49d2939b99e0083683e7b.png" src="_images/a9b6fcd82e4f8e69fa8ff9d699a71dc0ef55eb4ac0c49d2939b99e0083683e7b.png" />
</div>
</div>
<p>We can implement a range function that works with any beacon:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rfid_range</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">beacon</span><span class="p">,</span> <span class="n">max_range</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;return range to given beacon&quot;&quot;&quot;</span>
    <span class="nb">range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">position</span><span class="o">-</span><span class="n">beacon</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">range</span><span class="o">&gt;</span><span class="n">max_range</span> <span class="k">else</span> <span class="nb">range</span>
</pre></div>
</div>
</div>
</div>
<p>For example, if the robot is at <span class="math notranslate nohighlight">\((20.5, 7.5)\)</span>, we are within range of beacon <span class="math notranslate nohighlight">\(0\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Point2</span><span class="p">(</span><span class="mf">20.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">)</span>
<span class="n">beacon0</span> <span class="o">=</span> <span class="n">logistics</span><span class="o">.</span><span class="n">beacons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">zk</span> <span class="o">=</span> <span class="n">rfid_range</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">beacon0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range to beacon 0 = </span><span class="si">{</span><span class="n">zk</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>range to beacon 0 = 4.03
</pre></div>
</div>
</div>
</div>
<p>Now we are in a position to show the annulus-like likelihood images:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| caption: The likelihood of locations in the map when measuring a range of 4 meters to beacon 0.</span>
<span class="c1">#| label: fig:logistics_likelihood_beacon0</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">rfid_range</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">beacon0</span><span class="p">)</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">logistics</span><span class="o">.</span><span class="n">map_coords</span><span class="p">])</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># In meters</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">zk</span> <span class="o">-</span> <span class="n">dist</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">logistics</span><span class="o">.</span><span class="n">show_map</span><span class="p">(</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">logistics</span><span class="o">.</span><span class="n">beacons</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/50e9d3a85d441ab0cba2f0c78486873b674dfc39a06c658820d3ef8b6b1ad30b.png" src="_images/50e9d3a85d441ab0cba2f0c78486873b674dfc39a06c658820d3ef8b6b1ad30b.png" />
</div>
</div>
<p>As you can see, <em>all</em> positions at a range of approximately 4 meters have a high likelihood.</p>
</section>
<section id="the-case-of-no-beacons-in-sensing-range">
<h2><span class="section-number">4.3.3. </span>The Case of No Beacons in Sensing Range<a class="headerlink" href="#the-case-of-no-beacons-in-sensing-range" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>The absence of beacons in the sensor data can be informative.</p>
</div></blockquote>
<p>The likelihood model above is useful when a beacon is within sensing range of the RFID reader. But what happens when all beacons are out of range? Let us assume that the RFID reader always returns the range to the closest beacon, along with its identification number, but it returns a special value when all the beacons are out of range. Formally, we can model this as a <em>pair</em> of values that is returned by the sensor,</p>
<div class="amsmath math notranslate nohighlight" id="equation-f841868d-424c-445a-8dd1-a447e6314476">
<span class="eqno">(4.33)<a class="headerlink" href="#equation-f841868d-424c-445a-8dd1-a447e6314476" title="Permalink to this equation">#</a></span>\[\begin{equation}
z_{RFID}\in \bar{N} \times \mathbb{\bar{R}}^+,
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{N}\)</span> is the set of integers extended with <code class="docutils literal notranslate"><span class="pre">None</span></code>, and <span class="math notranslate nohighlight">\(\mathbb{\bar{R}}^+\)</span> is the set of positive real numbers extended with <span class="math notranslate nohighlight">\(\infty\)</span>. Note that in the case of additive Gaussian sensor noise, it is possible to
have <span class="math notranslate nohighlight">\(z_k &lt; 0\)</span> returned by the range sensor. In such cases, we might simply assign <span class="math notranslate nohighlight">\(z_k = 0\)</span>.</p>
<p>In code this easy to implement: if all sensors are out of range we  return <code class="docutils literal notranslate"><span class="pre">None</span></code> for the identification and <code class="docutils literal notranslate"><span class="pre">float('inf')</span></code> for the range. For example, here is some code that returns the range to the nearest beacon (given in a list <code class="docutils literal notranslate"><span class="pre">beacons</span></code>) and <code class="docutils literal notranslate"><span class="pre">None,</span> <span class="pre">float('inf')</span></code> if all are out of range:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rfid_measurement</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">max_range</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate RFID reader that returns nearest RFID range or (None,inf).&quot;&quot;&quot;</span>
    <span class="n">ranges</span> <span class="o">=</span> <span class="p">[</span><span class="n">rfid_range</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">beacon</span><span class="p">,</span> <span class="n">max_range</span><span class="p">)</span> <span class="k">for</span> <span class="n">beacon</span> <span class="ow">in</span> <span class="n">logistics</span><span class="o">.</span><span class="n">beacons</span><span class="p">]</span>
    <span class="nb">range</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ranges</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">ranges</span><span class="p">),</span> <span class="nb">range</span><span class="p">)</span> <span class="k">if</span> <span class="nb">range</span><span class="o">&lt;=</span><span class="n">max_range</span> <span class="k">else</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="nb">range</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rfid_measurement</span><span class="p">(</span><span class="n">gtsam</span><span class="o">.</span><span class="n">Point2</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">7</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rfid_measurement</span><span class="p">(</span><span class="n">gtsam</span><span class="o">.</span><span class="n">Point2</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 4.716990566028302)
(None, inf)
</pre></div>
</div>
</div>
</div>
<p>The special “out of range” measurement conveys a lot of information as well! If we are within range of a sensor, the likelihood function is as above (an annulus). But when we are <em>out</em> of range, the likelihood function has a very strange shape indeed: it will be 1.0 for all continuous states out of range of all beacons, and zero for states within range of a beacon. This makes sense: if the robot were within range of a beacon, the sensor would have returned
an actual range, <em>not</em> infinity. This in turn tells us that the robot must be somewhere outside the range of all beacons, which is very powerful information. The likelihood for this case can be plotted with the following code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">out_of_rfid_range</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">max_range</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">rfid_measurement</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">max_range</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">id</span> <span class="o">==</span> <span class="kc">None</span>

<span class="n">out_of_bound_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">out_of_rfid_range</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">logistics</span><span class="o">.</span><span class="n">map_coords</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| caption: The likelihood of locations in the map when the range to the nearest beacon is out of range.</span>
<span class="c1">#| label: fig:logistics_likelihood_out_of_bound</span>
<span class="n">logistics</span><span class="o">.</span><span class="n">show_map</span><span class="p">(</span><span class="n">out_of_bound_map</span><span class="p">,</span> <span class="n">logistics</span><span class="o">.</span><span class="n">beacons</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/40b1335389a10ccf89a0c675f11933f3964ffde87c7037372249e6a31d548c16.png" src="_images/40b1335389a10ccf89a0c675f11933f3964ffde87c7037372249e6a31d548c16.png" />
</div>
</div>
</section>
<section id="a-gps-like-location-sensor">
<h2><span class="section-number">4.3.4. </span>A GPS-Like Location Sensor<a class="headerlink" href="#a-gps-like-location-sensor" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>A simple conditionally Gaussian measurement.</p>
</div></blockquote>
<p>The last sensor we will consider, a GPS-like location sensor, is a bit of a cheat. In fact, there are no great indoor GPS-like sensors.
People have tried all kinds of things, like triangulating WiFi signals etc., but a cheap and reliable GPS-like sensor that works indoors is still not available at the time of writing.
However, it is a good illustrative example to introduce a simple, conditionally Gaussian measurement.
Also, it can be a good way to model a more complicated sensor, e.g., a camera-based localization system that uses some type of map.</p>
<p id="index-2">The <strong>measurement model</strong> <span class="math notranslate nohighlight">\(h(x_k)\)</span>, that predicts the measurement <span class="math notranslate nohighlight">\(z_k\)</span> given the state <span class="math notranslate nohighlight">\(x_k\)</span>, will again be a conditional Gaussian. In this example, let us assume the measurement is simply the location of the robot, but with coordinates measured in <em>cm</em>. The measurement model in this case is <em>linear</em>, and we again assume additive noise:</p>
<div class="amsmath math notranslate nohighlight" id="equation-45a505da-e1d1-4b20-9571-184d10b5aefe">
<span class="eqno">(4.34)<a class="headerlink" href="#equation-45a505da-e1d1-4b20-9571-184d10b5aefe" title="Permalink to this equation">#</a></span>\[\begin{equation}
{z}_k = h(x_k) + w_k = C x_k + w_k
\end{equation}\]</div>
<p>The matrix <span class="math notranslate nohighlight">\(C\)</span> performs a linear transformation on the state, such as converting
between different units.
Suppose for example that the state is defined in meters and the sensor measures in
centimeters.
In this case, we could use the <span class="math notranslate nohighlight">\(2\times2\)</span> diagonal matrix <span class="math notranslate nohighlight">\(C=\text{diag}(100,100)\)</span> to
apply the appropriate scaling factor to convert from meters to centimeters.
Under the assumption that <span class="math notranslate nohighlight">\(w_k\)</span> is again zero-mean, Gaussian noise, the conditional density <span class="math notranslate nohighlight">\(p(z_k|x_k)\)</span> of the measurement <span class="math notranslate nohighlight">\(z_k\)</span> given the state <span class="math notranslate nohighlight">\(x_k\)</span> is then</p>
<div class="amsmath math notranslate nohighlight" id="equation-3ec49c73-67ee-4292-a110-b1a92d082135">
<span class="eqno">(4.35)<a class="headerlink" href="#equation-3ec49c73-67ee-4292-a110-b1a92d082135" title="Permalink to this equation">#</a></span>\[\begin{equation}
\begin{aligned}
p(z_k|x_k) &amp;= \mathcal{N}(z_k;\mu=C x_k, \Sigma=R) \\
&amp;= \frac{1}{\sqrt{2\pi  |R|}} \exp\{-0.5 (z_k-C x_k)^TR^{-1}(z_k-C x_k)\}
\end{aligned}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is the traditional symbol used for measurement model covariance,
and <span class="math notranslate nohighlight">\(|R|\)</span> in the denominator denotes the determinant of <span class="math notranslate nohighlight">\(R\)</span>. Assuming a fairly inaccurate sensor, with 30cm standard deviation, we have <span class="math notranslate nohighlight">\(R=\text{diag}(30^2,30^2)\)</span> if the uncertainties in the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> directions are independent of one another. Note that the <span class="math notranslate nohighlight">\(2\times 2\)</span> measurement covariance matrix <span class="math notranslate nohighlight">\(R\)</span> is expressed in the units of the measurement, i.e., centimeters, <em>not</em> the units of the state.</p>
</section>
<section id="simulating-states-and-measurements">
<h2><span class="section-number">4.3.5. </span>Simulating States <em>and</em> Measurements<a class="headerlink" href="#simulating-states-and-measurements" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>Dynamic Bayes nets to the rescue, again!</p>
</div></blockquote>
<p>We can now extend the Gaussian DBN from the previous section to include  measurements, so that we can
encode the joint density <span class="math notranslate nohighlight">\(p(X,Z|U)\)</span> on states <span class="math notranslate nohighlight">\(X\)</span> <em>and</em> measurements <span class="math notranslate nohighlight">\(Z\)</span>, given the controls <span class="math notranslate nohighlight">\(U\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-1e651aae-47bc-46e9-84f1-eb65a60c82a7">
<span class="eqno">(4.36)<a class="headerlink" href="#equation-1e651aae-47bc-46e9-84f1-eb65a60c82a7" title="Permalink to this equation">#</a></span>\[\begin{equation}
p(X,Z|U) = p(x_1)p(z_1|x_1) \prod_{k=2}^N p(x_k|x_{k-1}, u_{k-1})p(z_k|x_k).
\end{equation}\]</div>
<p>Let us add the measurement conditionals to the DBN from the previous section to get an extended dynamic Bayes net:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gaussianBayesNet</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">GaussianBayesNet</span><span class="p">()</span>
<span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">motion_model_sigma</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">measurement_model_sigma</span> <span class="o">=</span> <span class="mi">30</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
    <span class="n">gaussianBayesNet</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">gtsam</span><span class="o">.</span><span class="n">GaussianConditional</span><span class="o">.</span><span class="n">FromMeanAndStddev</span><span class="p">(</span>
        <span class="n">z</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">C</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">measurement_model_sigma</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">gaussianBayesNet</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">gtsam</span><span class="o">.</span><span class="n">GaussianConditional</span><span class="o">.</span><span class="n">FromMeanAndStddev</span><span class="p">(</span>
        <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">B</span><span class="p">,</span> <span class="n">u</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">motion_model_sigma</span><span class="p">))</span>
<span class="n">p_x1</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">GaussianDensity</span><span class="o">.</span><span class="n">FromMeanAndStddev</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">gaussianBayesNet</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p_x1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| caption: A dynamics Bayes Net for our logistics robot.</span>
<span class="c1">#| label: fig:logistics_bayes_net</span>
<span class="n">position_hints</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">show</span><span class="p">(</span><span class="n">gaussianBayesNet</span><span class="p">,</span> <span class="n">hints</span><span class="o">=</span><span class="n">position_hints</span><span class="p">,</span> <span class="n">boxes</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/73786d0615aeb5d94644aa04190a645dddda4db969429c48bdf98132bbccee49.svg" src="_images/73786d0615aeb5d94644aa04190a645dddda4db969429c48bdf98132bbccee49.svg" />
</div>
</div>
<p>This now allows us to simulate a trajectory and <em>simultaneously</em> simulate a set of measurements:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">control_tape</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">VectorValues</span><span class="p">()</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">ux</span><span class="p">,</span><span class="n">uy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)]):</span>
    <span class="n">control_tape</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">Point2</span><span class="p">(</span><span class="n">ux</span><span class="p">,</span><span class="n">uy</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gaussianBayesNet</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">control_tape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<table class='VectorValues'>
  <thead>
    <tr><th>Variable</th><th>value</th></tr>
  </thead>
  <tbody>
    <tr><th>u1</th><td>2 0</td></tr>
    <tr><th>u2</th><td>2 0</td></tr>
    <tr><th>u3</th><td>0 2</td></tr>
    <tr><th>u4</th><td>0 2</td></tr>
    <tr><th>x1</th><td>20.3525 9.71295</td></tr>
    <tr><th>x2</th><td>21.9712 9.56813</td></tr>
    <tr><th>x3</th><td>23.9742 9.77767</td></tr>
    <tr><th>x4</th><td>23.9099 11.6501</td></tr>
    <tr><th>x5</th><td>23.7314 13.1453</td></tr>
    <tr><th>z1</th><td>2008.52 945.492</td></tr>
    <tr><th>z2</th><td>2211.69 884.474</td></tr>
    <tr><th>z3</th><td>2386.12 950.037</td></tr>
    <tr><th>z4</th><td>2413.53 1149.09</td></tr>
    <tr><th>z5</th><td>2360.21 1289.66</td></tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="gps-style-likelihoods">
<h2><span class="section-number">4.3.6. </span>GPS-style Likelihoods<a class="headerlink" href="#gps-style-likelihoods" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>A likelihood is not a probability. A likelihood is not a probability. A likelihood is not a probability.</p>
</div></blockquote>
<p>Let us recall the definition of the likelihood of a state <span class="math notranslate nohighlight">\(x\)</span> from section 2.4, as being a function <em>proportional</em> to the conditional density of a measurement <span class="math notranslate nohighlight">\(z\)</span>, but viewed as a function of <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-8ae043a8-877a-4368-8fbd-0bb29892bd6c">
<span class="eqno">(4.37)<a class="headerlink" href="#equation-8ae043a8-877a-4368-8fbd-0bb29892bd6c" title="Permalink to this equation">#</a></span>\[\begin{equation}
L(x;z) \propto p(z|x).
\end{equation}\]</div>
<p>The notation emphasizes that the measurement <span class="math notranslate nohighlight">\(z\)</span> is given, and the likelihood is a function defined on the <em>continuous</em> state <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>What is the likelihood function for our GPS-like sensor? That’s easy enough: we take the conditional probability, drop the normalization constant, and view it as a function of the state <span class="math notranslate nohighlight">\(x_k\)</span> rather than the <em>known</em> measurement <span class="math notranslate nohighlight">\(z_k\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-faa4a799-10dd-4b92-a63f-1ed6aba57cb1">
<span class="eqno">(4.38)<a class="headerlink" href="#equation-faa4a799-10dd-4b92-a63f-1ed6aba57cb1" title="Permalink to this equation">#</a></span>\[\begin{equation}
L(x_k;z_k) \doteq \exp\{-0.5 (z_k-C x_k)^TR^{-1}(z_k-C x_k)\}
\end{equation}\]</div>
<p>It turns out that in this case (when <span class="math notranslate nohighlight">\(C\)</span> is a square, nonsingular matrix,
and <span class="math notranslate nohighlight">\(x_k, z_k \in \mathbb{R}^n\)</span>), the likelihood function <em>looks</em> just like a Gaussian, because we can re-write the above as</p>
<div class="amsmath math notranslate nohighlight" id="equation-ff211e56-a0f3-4432-932f-d3da8dea82df">
<span class="eqno">(4.39)<a class="headerlink" href="#equation-ff211e56-a0f3-4432-932f-d3da8dea82df" title="Permalink to this equation">#</a></span>\[\begin{equation}
\begin{aligned}
L(x_k;z_k) \doteq \exp\{-0.5 (x_k-C^{-1}z_k)^T C^T R^{-1}C(x_k-C^{-1}z_k)\}
\end{aligned}
\end{equation}\]</div>
<p>which is <em>proportional</em> to a Gaussian density with mean <span class="math notranslate nohighlight">\(C^{-1}z_k\)</span> and covariance matrix <span class="math notranslate nohighlight">\(\Sigma=(C^T R^{-1}C)^{-1}=C^{-1}RC^{-T}\)</span>. This actually makes sense: the most <em>likely</em> state <span class="math notranslate nohighlight">\(x_k\)</span> given a measurement <span class="math notranslate nohighlight">\(z_k\)</span> is just the measurement, now <em>divided</em> by 100 to convert to meters, hence the <span class="math notranslate nohighlight">\(C^{-1}\)</span>. The covariance is scaled down by 10,000. However, it is important not to go too far and start interpreting this Gaussian-shaped function as a probability: it does not normalize to 1, and it is a coincidence that for <em>linear-conditional</em> Gaussians, the likelihood turns out to be Gaussian-shaped as well.</p>
</section>
<section id="gtbook-101">
<h2><span class="section-number">4.3.7. </span>GTbook 101<a class="headerlink" href="#gtbook-101" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>About code defined in gtbook library.</p>
</div></blockquote>
<p>Again we used some code defined in the <code class="docutils literal notranslate"><span class="pre">gtbook</span></code> library:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">logistics.base_map</span></code>: a 50x100 image with the warehouse shelves</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">logistics.beacons</span></code>: an 8x2 array of beacon locations</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="S42_logistics_actions.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4.2. </span>Moving in 2D</p>
      </div>
    </a>
    <a class="right-next"
       href="S44_logistics_perception.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.4. </span>Localization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-proximity-sensor">4.3.1. A proximity sensor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-range-sensor">4.3.2. A Range Sensor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-case-of-no-beacons-in-sensing-range">4.3.3. The Case of No Beacons in Sensing Range</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-gps-like-location-sensor">4.3.4. A GPS-Like Location Sensor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-states-and-measurements">4.3.5. Simulating States <em>and</em> Measurements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gps-style-likelihoods">4.3.6. GPS-style Likelihoods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gtbook-101">4.3.7. GTbook 101</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Frank Dellaert and Seth Hutchinson
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>