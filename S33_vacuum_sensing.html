
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.3. Dynamic Bayesian Networks &#8212; Introduction to Robotics and Perception</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/style.css?v=51e3b7cf" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=c73c0f3e"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'S33_vacuum_sensing';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3.4. Perception with Graphical Models" href="S34_vacuum_perception.html" />
    <link rel="prev" title="3.2. Actions over time" href="S32_vacuum_actions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Introduction to Robotics and Perception - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Introduction to Robotics and Perception - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="S10_introduction.html">1. Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S11_models.html">1.1. Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="S12_reasoning.html">1.2. Reasoning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S13_math.html">1.3. The Mathematics of Robotics</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S20_sorter_intro.html">2. A Trash Sorting Robot</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S21_sorter_state.html">2.1. Modeling the World State</a></li>
<li class="toctree-l2"><a class="reference internal" href="S22_sorter_actions.html">2.2. Actions for Sorting Trash</a></li>
<li class="toctree-l2"><a class="reference internal" href="S23_sorter_sensing.html">2.3. Sensors for Sorting Trash</a></li>
<li class="toctree-l2"><a class="reference internal" href="S24_sorter_perception.html">2.4. Perception</a></li>
<li class="toctree-l2"><a class="reference internal" href="S25_sorter_decision_theory.html">2.5. Decision Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="S26_sorter_learning.html">2.6. Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S27_sorter_summary.html">2.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="S30_vacuum_intro.html">3. A Robot Vacuum Cleaner</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="S31_vacuum_state.html">3.1. Modeling the State of the Vacuum Cleaning Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="S32_vacuum_actions.html">3.2. Actions over time</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.3. Dynamic Bayesian Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="S34_vacuum_perception.html">3.4. Perception with Graphical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="S35_vacuum_decision.html">3.5. Markov Decision Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="S36_vacuum_RL.html">3.6. Learning to Act Optimally</a></li>
<li class="toctree-l2"><a class="reference internal" href="S37_vacuum_summary.html">3.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S40_logistics_intro.html">4. Warehouse Robots in 2D</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S41_logistics_state.html">4.1. Continuous State</a></li>
<li class="toctree-l2"><a class="reference internal" href="S42_logistics_actions.html">4.2. Moving in 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="S43_logistics_sensing.html">4.3. Sensor Models with Continuous State</a></li>
<li class="toctree-l2"><a class="reference internal" href="S44_logistics_perception.html">4.4. Localization</a></li>
<li class="toctree-l2"><a class="reference internal" href="S45_logistics_planning.html">4.5. Planning for Logistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="S46_logistics_learning.html">4.6. Some System Identification</a></li>
<li class="toctree-l2"><a class="reference internal" href="S47_logistics_summary.html">4.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S50_diffdrive_intro.html">5. A Mobile Robot With Simple Kinematics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S51_diffdrive_state.html">5.1. State Space for a differential-drive robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="S52_diffdrive_actions.html">5.2. Motion Model for the Differential Drive Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="S53_diffdrive_sensing.html">5.3. Cameras for Robot Vision</a></li>
<li class="toctree-l2"><a class="reference internal" href="S54_diffdrive_perception.html">5.4. Computer Vision 101</a></li>
<li class="toctree-l2"><a class="reference internal" href="S55_diffdrive_planning.html">5.5. Path Planning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S56_diffdrive_learning.html">5.6. Deep Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S57_diffdrive_summary.html">5.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S60_driving_intro.html">6. Autonomous Vehicles</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S61_driving_state.html">6.1. Planar Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="S62_driving_actions.html">6.2. Kinematics for Driving</a></li>
<li class="toctree-l2"><a class="reference internal" href="S63_driving_sensing.html">6.3. Sensing for Autonomous Vehicles</a></li>
<li class="toctree-l2"><a class="reference internal" href="S64_driving_perception.html">6.4. SLAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="S65_driving_planning.html">6.5. Planning for Autonomous Driving.</a></li>
<li class="toctree-l2"><a class="reference internal" href="S66_driving_DRL.html">6.6. Deep Reinforcement Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="S67_driving_summary.html">6.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="S70_drone_intro.html">7. Autonomous Drones in 3D</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="S71_drone_state.html">7.1. Moving in Three Dimensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="S72_drone_actions.html">7.2. Multi-rotor Aircraft</a></li>
<li class="toctree-l2"><a class="reference internal" href="S73_drone_sensing.html">7.3. Sensing for Drones</a></li>
<li class="toctree-l2"><a class="reference internal" href="S74_drone_perception.html">7.4. Visual SLAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="S75_drone_planning.html">7.5. Trajectory Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="S76_drone_learning.html">7.6. Neural Radiance Fields for Drones</a></li>
<li class="toctree-l2"><a class="reference internal" href="S77_drone_summary.html">7.7. Chapter Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">8. Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/S33_vacuum_sensing.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Dynamic Bayesian Networks</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-sensor-model">3.3.1. A Sensor Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">3.3.1.1. Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-dynamic-bayes-nets">3.3.2. Introducing Dynamic Bayes Nets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ancestral-sampling">3.3.3. Ancestral Sampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-of-a-robot">3.3.4. Simulation of a Robot</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">3.3.4.1. Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ancestral-sampling-with-gtsam">3.3.5. Ancestral Sampling with GTSAM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3.3.5.1. Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gtsam-101">3.3.6. GTSAM 101</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="dynamic-bayesian-networks">
<h1><span class="section-number">3.3. </span>Dynamic Bayesian Networks<a class="headerlink" href="#dynamic-bayesian-networks" title="Link to this heading">#</a></h1>
<p><a href="https://colab.research.google.com/github/gtbook/robotics/blob/main/S33_vacuum_sensing.ipynb" target="_parent"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<blockquote id="index-0">
<div><p>Dynamic Bayes nets replicate a Bayes net fragment over time.</p>
</div></blockquote>
<a class="reference internal image-reference" href="_images/S33-iRobot_vacuuming_robot-01.jpg"><img alt="Splash image with balancing steampunk robot sporting big eyes" class="align-center" src="_images/S33-iRobot_vacuuming_robot-01.jpg" style="width: 40%;" /></a>
<p id="index-1">The concepts we discussed in the previous section can be generalized to include sensing, and here we introduce a much more general framework that we will use over and over in this book.
In particular, the controlled Markov chain over successive states <span class="math notranslate nohighlight">\(X_t\)</span> is an instance of a <strong>dynamic Bayes net</strong> or <strong>DBN</strong>:
a Bayes net in which <em>Bayes net slices</em> are replicated through time to model the evolution of states over time.
Below, we add observations/measurements into the mix and show how we can simulate the complete system using a more general technique called <em>ancestral sampling</em>.</p>
<p id="index-2">While most of the sensor modeling here is largely a reprise of Section 2.3, the concept of a dynamic Bayes net is an incredible modeling tool that we will use repeatedly throughout this book.
The notion of ancestral sampling is also very powerful and underlies simulation for much more general robot systems, not just the discrete-state model we consider here.</p>
<section id="a-sensor-model">
<h2><span class="section-number">3.3.1. </span>A Sensor Model<a class="headerlink" href="#a-sensor-model" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>A simple light sensor.</p>
</div></blockquote>
<p>This chapter is primarily focused on action, and hence the sensing we will consider is fairly straightforward.
Let us conceive of a simple light sensor that we can use as a clue about which room the robot is in.
Specifically, let us assume for illustration’s sake that the living room and kitchen are on the south side, and hence have a lot of light on a typical day.
The office and the dining room are on the north side, and the light sensor will typically respond with medium light levels.
The hallway, on the other hand, is very dark as it has few windows.
We can capture these semantics with a conditional probability distribution <span class="math notranslate nohighlight">\(P(Z_t|X_t)\)</span>, where <span class="math notranslate nohighlight">\(X_t\)</span> is the state at time <span class="math notranslate nohighlight">\(t\)</span> as before, and <span class="math notranslate nohighlight">\(Z_t \in \{\text{dark}, \text{medium}, \text{light}\}\)</span> is the measured light level.</p>
<p>The small code snippet in Figure <a class="reference internal" href="#fig:vacuum-sensor-spec"><span class="xref myst">1</span></a> is one way to create a reasonable sensor model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| caption: Creating a sensor model $P(Z_t|X_t)$ using a string-based specification.</span>
<span class="c1">#| label: fig:vacuum-sensor-spec</span>
<span class="c1"># vacuum.light_levels = [&quot;dark&quot;, &quot;medium&quot;, &quot;light&quot;]</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">VARIABLES</span><span class="o">.</span><span class="n">discrete_series</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">vacuum</span><span class="o">.</span><span class="n">light_levels</span><span class="p">)</span> <span class="c1"># define variables</span>
<span class="c1"># vacuum.sensor_spec = &quot;1/1/8 1/1/8 2/7/1 8/1/1 1/8/1&quot;</span>
<span class="n">pretty</span><span class="p">(</span><span class="n">gtsam</span><span class="o">.</span><span class="n">DiscreteConditional</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">vacuum</span><span class="o">.</span><span class="n">sensor_spec</span><span class="p">))</span> <span class="c1"># CPT on Z1 at time t=1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<p>  <i>P(Z1|X1):</i></p>
<table class='DiscreteConditional'>
  <thead>
    <tr><th><i>X1</i></th><th>dark</th><th>medium</th><th>light</th></tr>
  </thead>
  <tbody>
    <tr><th>Living Room</th><td>0.1</td><td>0.1</td><td>0.8</td></tr>
    <tr><th>Kitchen</th><td>0.1</td><td>0.1</td><td>0.8</td></tr>
    <tr><th>Office</th><td>0.2</td><td>0.7</td><td>0.1</td></tr>
    <tr><th>Hallway</th><td>0.8</td><td>0.1</td><td>0.1</td></tr>
    <tr><th>Dining Room</th><td>0.1</td><td>0.8</td><td>0.1</td></tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>There are several things to notice.</p>
<ul class="simple">
<li><p>This is again a <em>discrete</em> sensor; we have encountered these before in Chapter 2.</p></li>
<li><p>It is an imperfect sensor, and hence each room has a most likely outcome, but all outcomes are possible in all rooms.</p></li>
<li><p>The CPT (conditional probability table) above also captures modeling issues, such as varying light levels throughout the day.</p></li>
</ul>
<section id="exercise">
<h3><span class="section-number">3.3.1.1. </span>Exercise<a class="headerlink" href="#exercise" title="Link to this heading">#</a></h3>
<p>Change the values in the CPT and see how those changes affect the rest of the code in this section. Specifically, try some CPT versions where some outcomes have zero probability.</p>
</section>
</section>
<section id="introducing-dynamic-bayes-nets">
<h2><span class="section-number">3.3.2. </span>Introducing Dynamic Bayes Nets<a class="headerlink" href="#introducing-dynamic-bayes-nets" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>AXZ slices for the win!</p>
</div></blockquote>
<p>Single time step reasoning will fall short for our vacuuming robot, which operates in time. In perception, the game is to estimate the state given what was measured, but the ideas we discussed before will not apply directly. For example, recall the maximum likelihood method from the previous chapter, which we could try to apply here. In our case, given a sensor reading of, say, <span class="math notranslate nohighlight">\(Z_1\)</span>=<code class="docutils literal notranslate"><span class="pre">medium</span></code>, the maximum likelihood estimate (MLE) for the state <span class="math notranslate nohighlight">\(X_1\)</span> of the robot is <code class="docutils literal notranslate"><span class="pre">dining</span> <span class="pre">room</span></code>: it corresponds to the highest value in the <code class="docutils literal notranslate"><span class="pre">medium</span></code> column. But that takes only <em>one</em> measurement into account, even if we take many steps in the environment.</p>
<p id="index-3">We use a <strong>dynamic Bayes net</strong>, a special type of Bayes net, to reason about multiple measurements.
Intuitively, we should be able to use the robot’s history to obtain a better estimate of its location. For example, if the robot were just in the living room, there is no way that it could have gotten to the dining room in a single step. In this section we will see how we can reason probabilistically about such things.</p>
<p>The key lies in unrolling time in a graph.
Recall that directed cycles are not allowed in a Bayes net, i.e., the
graph is acyclic. Hence, one might wonder how we deal with time: if a
robot is all about the sense-think-act cycle, would we not expect a
cycle in the graph when describing robots? The answer is to <em>unroll</em> time, as we show below.
When a Bayes net is used to unroll the evolution of a system or agent
over time, we call it a dynamic Bayes net or <strong>DBN</strong>.</p>
<p>To illustrate this we will once again resort to code. The piece of code in Figure <a class="reference internal" href="#fig:dbn_5"><span class="xref myst">2</span></a> builds the entire vacuuming robot dynamic Bayes net. Note that we take care to add CPTs of variables <em>before</em> we add the CPT on any of their parents (hence the <code class="docutils literal notranslate"><span class="pre">reversed</span></code> below) for reasons that will soon become clear.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| caption: A dynamic Bayes net modeling both actions and sensing.</span>
<span class="c1">#| label: fig:dbn_5</span>
<span class="n">dbn</span> <span class="o">=</span> <span class="n">gtsam</span><span class="o">.</span><span class="n">DiscreteBayesNet</span><span class="p">()</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dbn</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span> <span class="n">vacuum</span><span class="o">.</span><span class="n">sensor_spec</span><span class="p">)</span> <span class="c1"># Add measurement CPTs</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)):</span>
    <span class="n">dbn</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span> <span class="n">vacuum</span><span class="o">.</span><span class="n">action_spec</span><span class="p">)</span> <span class="c1"># Add transition CPTs</span>
<span class="n">dbn</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;0/0/1/0/0&quot;</span><span class="p">)</span> <span class="c1"># Add initial state CPT</span>

<span class="n">show</span><span class="p">(</span><span class="n">dbn</span><span class="p">,</span> <span class="n">hints</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span> <span class="n">boxes</span><span class="o">=</span><span class="p">{</span><span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b4f8ecda8d2a896467a1d4e07764e2717ff31f642b0ec8e5c7fc16d9f083e23d.svg" src="_images/b4f8ecda8d2a896467a1d4e07764e2717ff31f642b0ec8e5c7fc16d9f083e23d.svg" />
</div>
</div>
<p>Observe that after the first time step, the Bayes net is repeating the same “AXZ” pattern (or <em>slice</em>!) over and over again. Formally, the joint distribution <span class="math notranslate nohighlight">\(P(Z_{1:n},X_{1:n}|A_{1:n})\)</span> over states <span class="math notranslate nohighlight">\(X_{1:n} \doteq (X_1 \dots, X_n)\)</span> and measurements <span class="math notranslate nohighlight">\(Z_{1:n} \doteq (Z_1, \dots , Z_n)\)</span>, <em>given</em>
the action sequence <span class="math notranslate nohighlight">\(A_{1:n} \doteq (A_1, \dots , A_n)\)</span> can be computed, given the DBN factorization, as</p>
<div class="amsmath math notranslate nohighlight" id="equation-148a817c-cc4e-481f-ac7f-b6404bed94b7">
<span class="eqno">(3.15)<a class="headerlink" href="#equation-148a817c-cc4e-481f-ac7f-b6404bed94b7" title="Permalink to this equation">#</a></span>\[\begin{equation}
P(Z_{1:n},X_{1:n}|A_{1:n})= P(Z_1| X_1) P(X_1) \prod_{k=2}^{n} P(Z_k| X_k) P(X_k|A_{k-1},X_{k-1}).
\end{equation}\]</div>
<p>The AXZ slice at time <span class="math notranslate nohighlight">\(k\)</span> is given by <span class="math notranslate nohighlight">\(P(Z_k| X_k) P(X_k|A_{k-1},X_{k-1})\)</span>, whereas the chain is “jump-started” using the initial state distribution <span class="math notranslate nohighlight">\(P(X_1)\)</span> and the corresponding measurement model <span class="math notranslate nohighlight">\(P(Z_1|X_1)\)</span>.</p>
</section>
<section id="ancestral-sampling">
<h2><span class="section-number">3.3.3. </span>Ancestral Sampling<a class="headerlink" href="#ancestral-sampling" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>FOR DBNs, ancestry matters!</p>
</div></blockquote>
<p>How do we sample over such a complex Bayes net? To explain, recall the Bayes net example from Figure <a class="reference internal" href="#fig:general_bayes_net"><span class="xref myst">11</span></a> in the previous section. It has four variables W,X,Y,Z, and the joint distribution</p>
<div class="amsmath math notranslate nohighlight" id="equation-1455e703-d40f-4d86-93a9-501ff393ff37">
<span class="eqno">(3.16)<a class="headerlink" href="#equation-1455e703-d40f-4d86-93a9-501ff393ff37" title="Permalink to this equation">#</a></span>\[\begin{equation}
P(W,X,Y,Z)=P(W|X,Z)P(X|Y,Z)P(Y|Z)P(Z).
\end{equation}\]</div>
<p id="index-4">Sampling from the joint distribution given in Bayes net form can be done
by sampling each variable in turn, but making sure that we always sample
a node’s parents first. This can be done using the notion of a
<strong>topological sort</strong> of the DAG. A topological sort of a DAG is an ordering
of the vertices <span class="math notranslate nohighlight">\(\{v_1, \dots , v_n\}\)</span> such that <span class="math notranslate nohighlight">\(v_i\)</span> precedes <span class="math notranslate nohighlight">\(v_j\)</span> in the sort when there
is a directed edge from <span class="math notranslate nohighlight">\(v_i\)</span> to <span class="math notranslate nohighlight">\(v_j\)</span> in the DAG.</p>
<p id="index-5">An easy algorithm to obtain a topological sort is <strong>Kahn’s algorithm</strong>,
which iteratively removes nodes from the graph that either have no parents, or whose parents have all been removed already.
The order in which nodes are removed constitutes a (non-unique) topological sort order.</p>
<p>Sampling is then done by sampling from each variable separately, in topological sort order, as doing so will ensure each variable’s parent values are already available.
The example graph above happens to be laid out already in topological sort order, if read from top to bottom.
Hence, in this example we sample first <span class="math notranslate nohighlight">\(Z\)</span>, then <span class="math notranslate nohighlight">\(Y\)</span>, then <span class="math notranslate nohighlight">\(X\)</span>, and then <span class="math notranslate nohighlight">\(W\)</span>.
Note that in this case the topological sort happens to be unique, but that is an exception rather than the rule: for arbitrary Bayes nets, more than one topological sort can exist.</p>
</section>
<section id="simulation-of-a-robot">
<h2><span class="section-number">3.3.4. </span>Simulation of a Robot<a class="headerlink" href="#simulation-of-a-robot" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>Simulation as sampling, once again!</p>
</div></blockquote>
<p>Simulation of a robot is then equivalent
to ancestral sampling from the DBN associated with the robot, i.e., the controlled Markov chain augmented with the measurement CPTs.
In this case one topological sort is
rather obvious, and so is a simulation algorithm to sample from
<span class="math notranslate nohighlight">\(P(X_{1:n},Z_{1:n}|A_{1:n})\)</span>:</p>
<ol class="arabic simple">
<li><p>First, assign <span class="math notranslate nohighlight">\(k\leftarrow1\)</span>, and sample the initial state <span class="math notranslate nohighlight">\(x_1\)</span> from <span class="math notranslate nohighlight">\(P(X_1)\)</span>, a prior over the state. We write
$<span class="math notranslate nohighlight">\(
x_1 \sim P(X_1)
\)</span>$</p></li>
<li><p>Next, simulate the sensor reading by sampling from the sensor model
$<span class="math notranslate nohighlight">\(
z_{k} \sim P(Z_{k}|X_{k}=x_{k})
\)</span>$</p></li>
<li><p>Lastly, simulate the effect of the (given) action <span class="math notranslate nohighlight">\(a_k\)</span> by sampling the next state <span class="math notranslate nohighlight">\(x_{k+1}\)</span>:
$<span class="math notranslate nohighlight">\(
x_{k+1} \sim P(X_{k+1}|X_{k}=s_{k},A_{k}=a_{k}).
\)</span>$</p></li>
<li><p>Increase <span class="math notranslate nohighlight">\(k\leftarrow k+1\)</span> and return to step <span class="math notranslate nohighlight">\(2\)</span>.</p></li>
</ol>
<p>Note that this algorithm is generic for all robot models with this action/sensing structure.</p>
<section id="exercises">
<h3><span class="section-number">3.3.4.1. </span>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Simulate two different realizations from the dynamic Bayes net above.</p></li>
<li><p>Think of a different way to topologically sort the graph, and the corresponding sampling algorithm.</p></li>
</ol>
</section>
</section>
<section id="ancestral-sampling-with-gtsam">
<h2><span class="section-number">3.3.5. </span>Ancestral Sampling with GTSAM<a class="headerlink" href="#ancestral-sampling-with-gtsam" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>Simulation in code.</p>
</div></blockquote>
<p>Of course, GTSAM has a method built in to do ancestral sampling, <em>but</em> it only works for a <em>reverse</em> topologically sorted Bayes net. This matches the way we write down joint distributions, with parents towards the right, and it is also why above we used the built-in <code class="docutils literal notranslate"><span class="pre">reversed</span></code> on the range: this was to make sure that later states get sampled last. Because in our code above we only specified
<span class="math notranslate nohighlight">\(P(Z_{1:n},X_{1:n}|A_{1:n})\)</span>, and specifically did not provide a distribution over actions, we need to give an action sequence <span class="math notranslate nohighlight">\(a_{1:n}\)</span> as an argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| caption: Sampling from the DBN.</span>
<span class="c1">#| label: fig:dbn-sample</span>
<span class="n">actions</span> <span class="o">=</span> <span class="n">VARIABLES</span><span class="o">.</span><span class="n">assignment</span><span class="p">({</span><span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span> <span class="s2">&quot;R&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)})</span>
<span class="n">pretty</span><span class="p">(</span><span class="n">dbn</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">actions</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<table class='DiscreteValues'>
  <thead>
    <tr><th>Variable</th><th>value</th></tr>
  </thead>
  <tbody>
    <tr><th>A1</th><td>R</td></tr>
    <tr><th>A2</th><td>R</td></tr>
    <tr><th>A3</th><td>R</td></tr>
    <tr><th>A4</th><td>R</td></tr>
    <tr><th>X1</th><td>Office</td></tr>
    <tr><th>X2</th><td>Office</td></tr>
    <tr><th>X3</th><td>Hallway</td></tr>
    <tr><th>X4</th><td>Dining Room</td></tr>
    <tr><th>X5</th><td>Dining Room</td></tr>
    <tr><th>Z1</th><td>dark</td></tr>
    <tr><th>Z2</th><td>medium</td></tr>
    <tr><th>Z3</th><td>dark</td></tr>
    <tr><th>Z4</th><td>medium</td></tr>
    <tr><th>Z5</th><td>medium</td></tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As an example, in Figure <a class="reference internal" href="#fig:dbn-sample"><span class="xref myst">3</span></a> we examine what happens when we try the action <code class="docutils literal notranslate"><span class="pre">Right</span></code> 4 times in a row. The actions are included in the resulting <code class="docutils literal notranslate"><span class="pre">DiscreteValues</span></code> instance, so we have a complete picture of one sampled “world state” over time.
Note that the result now also includes the sampled measurements <span class="math notranslate nohighlight">\(Z_k\)</span> at each time step, in addition to the states <span class="math notranslate nohighlight">\(X_k\)</span>.
Not surprisingly, we quickly transition from the dark hallway to the slightly brighter dining room and get stuck there, as there is no room to the right of the dining room!</p>
<section id="id1">
<h3><span class="section-number">3.3.5.1. </span>Exercises<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Execute the cell above multiple times and observe you <em>do</em> get different realizations (almost) every time.</p></li>
<li><p>Try doing the same with different action sequences.</p></li>
<li><p>Try formulating an action sequence that gets you to the kitchen. Does it always succeed?</p></li>
</ul>
</section>
</section>
<section id="gtsam-101">
<h2><span class="section-number">3.3.6. </span>GTSAM 101<a class="headerlink" href="#gtsam-101" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>The GTSAM concepts used in this section, explained.</p>
</div></blockquote>
<p>We use the <code class="docutils literal notranslate"><span class="pre">DiscreteBayesNet</span></code> method <code class="docutils literal notranslate"><span class="pre">sample</span></code>, with signature</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">given</span><span class="p">:</span> <span class="n">gtsam</span><span class="p">::</span><span class="n">DiscreteValues</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gtsam</span><span class="p">::</span><span class="n">DiscreteValues</span>
</pre></div>
</div>
<p>It implements ancestral sampling, but does assume that the Bayes net is reverse topologically sorted, i.e. last
conditional will be sampled first. In addition, it can optionally take an assignment for certain <em>given</em> variables, as a <code class="docutils literal notranslate"><span class="pre">DiscreteValues</span></code> instance.
In that case, it is also assumed that the Bayes net does not contain any conditionals for the given values.
We used this functionality to pass the given action sequence above.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="S32_vacuum_actions.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3.2. </span>Actions over time</p>
      </div>
    </a>
    <a class="right-next"
       href="S34_vacuum_perception.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3.4. </span>Perception with Graphical Models</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-sensor-model">3.3.1. A Sensor Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">3.3.1.1. Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-dynamic-bayes-nets">3.3.2. Introducing Dynamic Bayes Nets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ancestral-sampling">3.3.3. Ancestral Sampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-of-a-robot">3.3.4. Simulation of a Robot</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">3.3.4.1. Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ancestral-sampling-with-gtsam">3.3.5. Ancestral Sampling with GTSAM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3.3.5.1. Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gtsam-101">3.3.6. GTSAM 101</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Frank Dellaert and Seth Hutchinson
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>